<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TUNAG „É¢„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó‰ΩúÊàê„ÉÑ„Éº„É´</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        tunag: {
                            blue: '#0055e8',
                            cyan: '#00aac2',
                            light: '#f4f6f9',
                            dark: '#1a202c'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
        
        /* Device Frames - PNGÁîªÂÉè„Çí‰ΩøÁî® */
        .device-frame-img {
            object-fit: contain;
            z-index: 20;
            pointer-events: none;
        }

        /* Canvas Area */
        #preview-canvas {
            transition: all 0.3s ease;
        }
        
        /* Layer Z-Index Management */
        #screen-area { z-index: 10; }
        .layer-frame { z-index: 20; pointer-events: none; }

        /* Editable highlight */
        [contenteditable]:hover {
            outline: 1px dashed #0055e8;
            cursor: text;
        }
        
        /* Tab Active State Utility */
        .tab-active {
            background-color: white;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            color: #0055e8;
            font-weight: 600;
        }
        .tab-inactive {
            color: #6b7280;
            font-weight: 500;
        }
        .tab-inactive:hover {
            color: #374151;
        }

        /* Preset/Builder Buttons */
        .btn-select {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: flex-start;
            padding: 6px 10px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            background-color: white;
            font-size: 11px;
            font-weight: 500;
            color: #4b5563;
            transition: all 0.2s;
            gap: 6px;
        }
        .btn-select:hover {
            background-color: #f9fafb;
            border-color: #d1d5db;
        }
        .btn-select.active {
            border-color: #0055e8;
            background-color: #eff6ff;
            color: #0055e8;
        }
        .btn-select i {
            font-size: 14px;
            flex-shrink: 0;
        }
    </style>
</head>
<body class="bg-gray-100 h-screen flex overflow-hidden font-sans text-gray-700">

    <!-- LEFT: Settings Panel -->
    <aside class="w-1/3 min-w-[340px] bg-white border-r border-gray-200 flex flex-col h-full shadow-lg z-30">
        <div class="p-5 border-b border-gray-100">
            <h1 class="text-2xl font-bold text-tunag-blue"><i class="fa-solid fa-layer-group mr-2"></i>Mockup Tool</h1>
            <p class="text-xs text-gray-400 mt-1">TUNAG „É¢„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó‰ΩúÊàê„ÉÑ„Éº„É´</p>
        </div>

        <div class="flex-1 overflow-y-auto p-5 space-y-8">
            
            <!-- Step 1: Content Mode -->
            <section>
                <h3 class="text-sm font-bold uppercase mb-3 tracking-wider">1. „Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÈÅ∏Êäû</h3>
                
                <!-- Tab Headers -->
                <div class="flex flex-col bg-gray-100 p-1 rounded-lg mb-4 gap-1">
                    <div class="flex w-full">
                        <button onclick="switchTab('preset')" id="tab-preset" class="flex-1 py-2 text-xs rounded transition tab-active">Êó¢Â≠ò„ÅÆÁîªÈù¢„Åã„ÇâÈÅ∏„Å∂</button>
                        <button onclick="switchTab('builder')" id="tab-builder" class="flex-1 py-2 text-xs rounded transition tab-inactive">„Ç´„Çπ„Çø„Éû„Ç§„Ç∫</button>
                        <button onclick="switchTab('test')" id="tab-test" class="flex-1 py-2 text-xs rounded transition tab-inactive">„ÉÜ„Çπ„Éà</button>
                        <button onclick="switchTab('upload')" id="tab-upload" class="flex-1 py-2 text-xs rounded transition tab-inactive">ÁîªÂÉè„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ</button>
                    </div>
                </div>

                <!-- Tab 1: Existing Screen Preset -->
                <div id="content-preset" class="space-y-3">
                    <!-- „Çø„Ç§„É†„É©„Ç§„É≥ÔºàÁã¨Á´ãÔºâ -->
                    <div class="mb-4">
                        <button onclick="applyPreset('timeline')" class="btn-select w-full">
                            <i class="fa-regular fa-newspaper text-blue-500"></i>
                            „Çø„Ç§„É†„É©„Ç§„É≥
                        </button>
                    </div>
                    
                    <!-- Âà∂Â∫¶Ë©≥Á¥∞Á≥ª -->
                    <div class="mb-4">
                        <p class="text-xs font-bold mb-2 uppercase tracking-wider">Âà∂Â∫¶Ë©≥Á¥∞</p>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="applyPreset('thankscard')" class="btn-select">
                                <i class="fa-solid fa-heart text-pink-500"></i>
                                „Çµ„É≥„ÇØ„Çπ„Ç´„Éº„Éâ
                        </button>
                            <button onclick="applyPreset('company_notice')" class="btn-select">
                                <i class="fa-solid fa-bullhorn text-blue-500"></i>
                                ‰ºöÁ§æ„Åã„Çâ„ÅÆ„ÅäÁü•„Çâ„Åõ
                        </button>
                            <button onclick="applyPreset('monthly_award')" class="btn-select">
                                <i class="fa-solid fa-trophy text-yellow-500"></i>
                                ÊúàÈñìË°®ÂΩ∞
                        </button>
                            <button onclick="applyPreset('president_message')" class="btn-select">
                                <i class="fa-solid fa-user-tie text-indigo-500"></i>
                                Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏
                        </button>
                        </div>
                    </div>
                    
                    <!-- ÊäïÁ®øË©≥Á¥∞Á≥ª -->
                    <div class="mb-4">
                        <p class="text-xs font-bold mb-2 uppercase tracking-wider">ÊäïÁ®øË©≥Á¥∞</p>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="applyPreset('post_company_notice')" class="btn-select">
                                <i class="fa-solid fa-bullhorn text-green-500"></i>
                                ‰ºöÁ§æ„Åã„Çâ„ÅÆ„ÅäÁü•„Çâ„Åõ
                            </button>
                            <button onclick="applyPreset('post_president_message')" class="btn-select">
                                <i class="fa-solid fa-user-tie text-purple-500"></i>
                                Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏
                        </button>
                        </div>
                    </div>
                </div>

                <!-- Tab 3: Test -->
                <div id="content-test" class="hidden space-y-3">
                    <p class="text-xs text-gray-500 mb-2">„ÉÜ„Çπ„ÉàÁî®„ÅÆÁîªÈù¢„ÇíÈÅ∏Êäû</p>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="applyTest('test_timeline')" class="btn-select">
                            <i class="fa-solid fa-list-ul text-orange-500"></i>
                            „Çø„Ç§„É†„É©„Ç§„É≥_Á§æÈï∑
                        </button>
                    </div>
                </div>

                <!-- Tab 2: Customize (Simple Builder) -->
                <div id="content-builder" class="hidden space-y-3">
                    <p class="text-xs text-gray-500 mb-2">„Éô„Éº„Çπ„Å®„Å™„ÇãÁîªÈù¢„Çø„Ç§„Éó„ÇíÈÅ∏Êäû„Åó„Å¶Á∑®ÈõÜ</p>
                    <div class="grid grid-cols-2 gap-2 mb-3">
                        <button onclick="applyBuilder('timeline')" class="btn-select">
                            <i class="fa-solid fa-list-ul"></i> „Çø„Ç§„É†„É©„Ç§„É≥
                        </button>
                        <button onclick="applyBuilder('chat')" class="btn-select">
                            <i class="fa-regular fa-comment-dots"></i> „ÉÅ„É£„ÉÉ„Éà
                        </button>
                        <button onclick="applyBuilder('portal')" class="btn-select">
                            <i class="fa-solid fa-table-columns"></i> „Éù„Éº„Çø„É´
                        </button>
                        <button onclick="applyBuilder('other')" class="btn-select">
                            <i class="fa-solid fa-shapes"></i> „Åù„ÅÆ‰ªñ
                        </button>
                    </div>
                    
                    <div class="p-3 border rounded bg-gray-50 text-xs text-gray-600">
                        <p class="font-bold mb-1">Á∑®ÈõÜ„ÅÆ„Éí„É≥„Éà:</p>
                        <ul class="list-disc pl-4 space-y-1">
                            <li>ÁîªÈù¢Âè≥ÂÅ¥„ÅÆ„Éó„É¨„Éì„É•„ÉºÂÜÖ„ÅÆÊñáÂ≠ó„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Êõ∏„ÅçÊèõ„Åà„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</li>
                            <li>„Ç¢„Ç§„Ç≥„É≥„ÇÑ„É¨„Ç§„Ç¢„Ç¶„Éà„ÅØ‰ªÆ„ÅÆ„ÉÄ„Éü„Éº„Åß„Åô„ÄÇ</li>
                        </ul>
                    </div>
                </div>

                <!-- Tab 3: Image Upload -->
                <div id="content-upload" class="hidden space-y-4">
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:bg-gray-50 transition cursor-pointer relative">
                        <input type="file" id="imageInput" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" onchange="handleImageUpload(this)">
                        <i class="fa-solid fa-cloud-arrow-up text-3xl text-gray-300 mb-2"></i>
                        <p class="text-sm text-gray-500">„Çπ„ÇØ„É™„Éº„É≥„Ç∑„Éß„ÉÉ„Éà„ÇíÈÅ∏Êäû</p>
                        <p class="text-xs text-gray-400 mt-1">(PNG, JPG ÂØæÂøú)</p>
                    </div>
                    <p class="text-xs text-tunag-blue"><i class="fa-solid fa-circle-info mr-1"></i>ÁîªÂÉè„ÇíÈÅ∏Êäû„Åô„Çã„Å®„Éà„É™„Éü„É≥„Ç∞ÁîªÈù¢„ÅåÈñã„Åç„Åæ„Åô</p>
                </div>
            </section>

            <!-- Step 2: Frame Toggle -->
            <section>
                <h3 class="text-sm font-bold uppercase mb-3 tracking-wider">2. Ë°®Á§∫Ë®≠ÂÆö</h3>
                <div class="flex items-center gap-2 p-2 bg-gray-50 rounded-lg">
                    <input type="checkbox" id="checkbox-no-frame" onchange="toggleFrame()" class="w-4 h-4 text-tunag-blue border-gray-300 rounded focus:ring-tunag-blue">
                    <label for="checkbox-no-frame" class="text-sm text-gray-700 cursor-pointer">Êû†„ÇíË°®Á§∫„Åó„Å™„ÅÑ</label>
                </div>
            </section>

        </div>

        <!-- Footer: Download -->
        <div class="p-5 border-t border-gray-200 bg-gray-50">
            <button onclick="downloadImage()" class="w-full bg-tunag-blue hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow transition flex justify-center items-center gap-2">
                <i class="fa-solid fa-download"></i> ÁîªÂÉè„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
            </button>
        </div>
    </aside>

    <!-- RIGHT: Preview Area -->
    <main class="w-2/3 h-full bg-gray-200 flex items-center justify-center relative overflow-hidden pattern-bg">
        <!-- Background Pattern -->
        <div class="absolute inset-0 opacity-10 pointer-events-none" style="background-image: radial-gradient(#9ca3af 1px, transparent 1px); background-size: 20px 20px;"></div>

        <!-- Capture Target -->
        <div id="capture-wrapper" class="relative transition-all duration-300">
            <!-- LAYER 1: DEVICE FRAME (z-20) -->
            <!-- PC Frame -->
            <img id="frame-pc" src="device/pc-mockup.png" class="layer-frame absolute inset-0 pointer-events-none w-full h-full object-contain" alt="PC Frame">


            <!-- LAYER 2: SCREEN AREA (z-10) - „É¢„ÉÉ„ÇØ„Ç¢„ÉÉ„ÉóÁîªÂÉè„ÅÆÁîªÈù¢ÈÉ®ÂàÜ„Å´ÈÖçÁΩÆ„Åï„Çå„Çãdiv -->
            <div id="screen-area" class="absolute overflow-hidden bg-white">
                <!-- Placeholder -->
                <div id="content-placeholder" class="w-full h-full flex flex-col items-center justify-center bg-gray-50 text-gray-300 absolute inset-0">
                    <i class="fa-solid fa-image text-4xl mb-2"></i>
                    <span class="text-sm font-medium">„Éó„É¨„Éì„É•„Éº„Ç®„É™„Ç¢</span>
                </div>
                
                <!-- Image -->
                <img id="content-img" src="" class="w-full h-full object-contain hidden" alt="User Content">

                <!-- HTML Builder -->
                <div id="content-html" class="w-full h-full hidden overflow-hidden">
                    <!-- Injected via JS -->
                </div>
            </div>
        </div>
    </main>

    <!-- MODAL: Cropper -->
    <div id="cropper-modal" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden flex flex-col items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl h-[80vh] flex flex-col overflow-hidden">
            <div class="p-4 border-b flex justify-between items-center">
                <h3 class="font-bold text-gray-700">ÁîªÂÉè„ÅÆÂàá„ÇäÊäú„Åç</h3>
                <button onclick="closeCropper()" class="text-gray-400 hover:text-gray-600"><i class="fa-solid fa-times text-xl"></i></button>
            </div>
            <div class="flex-1 bg-gray-100 relative overflow-hidden flex items-center justify-center p-2">
                <img id="cropper-target" src="" class="max-w-full max-h-full block">
            </div>
            <div class="p-4 border-t bg-gray-50 flex justify-end gap-3">
                <button onclick="closeCropper()" class="px-4 py-2 rounded text-gray-600 hover:bg-gray-200 transition">„Ç≠„É£„É≥„Çª„É´</button>
                <button onclick="applyCrop()" class="px-6 py-2 rounded bg-tunag-blue text-white font-bold hover:bg-blue-700 transition">Ê±∫ÂÆö</button>
            </div>
        </div>
    </div>

    <script>
        // --- Configuration & State ---
        const config = {
            width: 800,
            height: 600,
            aspectRatio: 800/600
        };
        
        // „É¢„ÉÉ„ÇØ„Ç¢„ÉÉ„ÉóÁîªÂÉè„ÅÆÁîªÈù¢ÈÉ®ÂàÜ„ÅÆ‰ΩçÁΩÆ„Å®„Çµ„Ç§„Ç∫ÔºàpxÊåáÂÆöÔºâ
        const screenAreaConfig = {
                leftPx: 53.5,        // Â∑¶„Åã„Çâ„ÅÆ‰ΩçÁΩÆÔºàpxÂõ∫ÂÆöÔºâ
                topPx: 5,           // ‰∏ä„Åã„Çâ„ÅÆ‰ΩçÁΩÆÔºàpxÂõ∫ÂÆöÔºâ
                widthPx: 492,       // ÂπÖÔºàpxÂõ∫ÂÆöÔºâ
                heightPx: 349.4     // È´ò„ÅïÔºàpxÂõ∫ÂÆöÔºâ
        };

        let state = {
            mode: 'preset', // „Éá„Éï„Ç©„É´„Éà„Çí„ÄåÊó¢Â≠ò„ÅÆÁîªÈù¢„Åã„ÇâÈÅ∏„Å∂„Äç„Å´Â§âÊõ¥
            cropper: null,
            lastPreset: 'timeline',
            lastBuilder: 'timeline',
            lastTest: 'test_timeline',
            showFrame: true  // Êû†„ÇíË°®Á§∫„Åô„Çã„Åã„Å©„ÅÜ„Åã
        };

        // --- DOM Elements ---
        let els = {};
        
        // ÁîªÂÉè„ÅÆ„Çµ„Ç§„Ç∫„Çí‰øùÊåÅ
        let frameImageSize = { width: 0, height: 0 };

        // --- Initialization ---
        window.onload = () => {
            // DOMË¶ÅÁ¥†„ÇíÂèñÂæó
            els = {
            wrapper: document.getElementById('capture-wrapper'),
            framePc: document.getElementById('frame-pc'),
            screenArea: document.getElementById('screen-area'),
            contentPlaceholder: document.getElementById('content-placeholder'),
            contentImg: document.getElementById('content-img'),
            contentHtml: document.getElementById('content-html'),
            modal: document.getElementById('cropper-modal'),
            cropperImg: document.getElementById('cropper-target'),
            input: document.getElementById('imageInput')
        };

            // Ë¶ÅÁ¥†„ÅåÂ≠òÂú®„Åô„Çã„ÅãÁ¢∫Ë™ç
            if (!els.wrapper) {
                console.error('DOMË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                return;
            }
            
            // ÁîªÂÉè„ÅÆË™≠„ÅøËæº„Åø„ÇíÂæÖ„Å§
            loadFrameImage();
        };
        
        // ÁîªÂÉè„ÇíË™≠„ÅøËæº„Çì„Åß„Çµ„Ç§„Ç∫„ÇíÂèñÂæó
        function loadFrameImage() {
            const pcImg = new Image();
            
            pcImg.onload = () => {
                frameImageSize = { width: pcImg.naturalWidth, height: pcImg.naturalHeight };
                updateSizeAndFrame();
                    // „Éá„Éï„Ç©„É´„Éà„Åßpreset„Çø„Éñ„ÇíË°®Á§∫
                    switchTab('preset');
            };
            pcImg.onerror = () => {
                console.error('PCÁîªÂÉè„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                // „Éá„Éï„Ç©„É´„Éà„Çµ„Ç§„Ç∫„Çí‰ΩøÁî®
                frameImageSize = { width: 800, height: 600 };
                updateSizeAndFrame();
                // „Éá„Éï„Ç©„É´„Éà„Åßpreset„Çø„Éñ„ÇíË°®Á§∫
                switchTab('preset');
            };
            pcImg.src = 'device/pc-mockup.png';
        }
        
        // „Çµ„Ç§„Ç∫„Å®Êû†„ÅÆË°®Á§∫„ÇíÊõ¥Êñ∞
        function updateSizeAndFrame() {
            if (!els.wrapper) return;
            
            const imageSize = frameImageSize;
            
            // ÂπÖ„Çí600px„Å´Âõ∫ÂÆö
            const targetWidth = 600;
                // È´ò„Åï„ÅØ„Ç¢„Çπ„Éö„ÇØ„ÉàÊØî„ÇíÁ∂≠ÊåÅ„Åó„Å¶Ë®àÁÆó
            let targetHeight;
                if (imageSize.width > 0 && imageSize.height > 0) {
                    const aspectRatio = imageSize.height / imageSize.width;
                    targetHeight = targetWidth * aspectRatio;
                } else {
                    // „Éá„Éï„Ç©„É´„Éà„Çµ„Ç§„Ç∫„Çí‰ΩøÁî®
                const aspectRatio = config.height / config.width;
                    targetHeight = targetWidth * aspectRatio;
                }
            
            // „Çµ„Ç§„Ç∫„ÇíË®≠ÂÆöÔºà600px„Å´Âõ∫ÂÆö„Åó„Å¶‰∏≠Â§ÆÈÖçÁΩÆÔºâ
                els.wrapper.style.width = `${targetWidth}px`;
                els.wrapper.style.height = `${targetHeight}px`;
                els.wrapper.style.margin = '0 auto';
            els.wrapper.style.borderRadius = '0';
            
            // Êû†„ÅÆË°®Á§∫/ÈùûË°®Á§∫
            updateFrameVisibility();
            
            // screen-area„ÅÆ‰ΩçÁΩÆ„Å®„Çµ„Ç§„Ç∫„ÇíË®≠ÂÆö
            updateScreenArea();
            
            // ÁîªÂÉè„ÅÆ„Çµ„Ç§„Ç∫„ÇíË™øÊï¥
            updateImageSize();
        }
        
        // screen-area„ÅÆ‰ΩçÁΩÆ„Å®„Çµ„Ç§„Ç∫„ÇíË®≠ÂÆö
        function updateScreenArea() {
            if (!els.screenArea || !els.wrapper) return;
            
            const wrapperWidth = els.wrapper.offsetWidth || els.wrapper.clientWidth;
            const wrapperHeight = els.wrapper.offsetHeight || els.wrapper.clientHeight;
            
            if (wrapperWidth > 0 && wrapperHeight > 0) {
                // „Çπ„Ç±„Éº„É´„ÇíË®àÁÆóÔºà600pxÂü∫Ê∫ñÔºâ
                const scale = wrapperWidth / 600;
                
                // screen-area„ÅÆ‰ΩçÁΩÆ„Å®„Çµ„Ç§„Ç∫„ÇíË®≠ÂÆöÔºà„Çπ„Ç±„Éº„É´ÈÅ©Áî®Ôºâ
                els.screenArea.style.left = `${screenAreaConfig.leftPx * scale}px`;
                els.screenArea.style.top = `${screenAreaConfig.topPx * scale}px`;
                els.screenArea.style.width = `${screenAreaConfig.widthPx * scale}px`;
                els.screenArea.style.height = `${screenAreaConfig.heightPx * scale}px`;
            }
        }
        
        // ÁîªÂÉè„ÅÆ„Çµ„Ç§„Ç∫„ÇíË™øÊï¥Ôºàscreen-areaÂÜÖ„Å´Âèé„ÇÅ„ÇãÔºâ
        function updateImageSize() {
            if (!els.contentImg || !els.screenArea) return;
            
            // ÁîªÂÉè„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØ„Çπ„Ç≠„ÉÉ„Éó
            if (els.contentImg.classList.contains('hidden') || !els.contentImg.src) return;
            
            // screen-area„ÅÆ„Çµ„Ç§„Ç∫„Å´Âêà„Çè„Åõ„Å¶ÁîªÂÉè„ÇíÈÖçÁΩÆ
            // screen-area„ÅØÊó¢„Å´overflow: hidden„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Çã„ÅÆ„Åß„ÄÅ
            // ÁîªÂÉè„ÅØ100%„ÅÆ„Çµ„Ç§„Ç∫„Åßcontain„ÅßÈÖçÁΩÆ„Åô„Çå„Å∞„ÅØ„ÅøÂá∫„Åï„Å™„ÅÑ
            els.contentImg.style.width = '100%';
            els.contentImg.style.height = '100%';
            els.contentImg.style.objectFit = 'contain';
        }
        
        // Êû†„ÅÆË°®Á§∫/ÈùûË°®Á§∫„ÇíÊõ¥Êñ∞
        function updateFrameVisibility() {
            const showFrame = state.showFrame;
            
                if (els.framePc) {
                    if (showFrame) {
                        els.framePc.style.display = 'block';
                els.framePc.classList.remove('hidden');
                    } else {
                        els.framePc.style.display = 'none';
                        els.framePc.classList.add('hidden');
                }
            }
        }
        
        // Êû†„ÅÆË°®Á§∫/ÈùûË°®Á§∫„ÇíÂàá„ÇäÊõø„Åà
        function toggleFrame() {
            const checkbox = document.getElementById('checkbox-no-frame');
            if (checkbox) {
                state.showFrame = !checkbox.checked;
                updateFrameVisibility();
            }
        }

        // --- Tab Switching ---
        function switchTab(mode) {
            if (!els.contentImg || !els.contentHtml) return; // DOMË¶ÅÁ¥†„ÅåÂàùÊúüÂåñ„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØÁµÇ‰∫Ü
            
            state.mode = mode;
            
            // Reset Tabs
            const tabs = ['upload', 'preset', 'builder', 'test'];
            tabs.forEach(t => {
                const el = document.getElementById(`tab-${t}`);
                const contentEl = document.getElementById(`content-${t}`);
                if (el && contentEl) {
                if (t === mode) {
                    el.className = el.className.replace('tab-inactive', 'tab-active');
                        contentEl.classList.remove('hidden');
                } else {
                    el.className = el.className.replace('tab-active', 'tab-inactive');
                        contentEl.classList.add('hidden');
                    }
                }
            });

            // Content Visibility Logic
            if (mode === 'upload') {
                if (els.contentHtml) els.contentHtml.classList.add('hidden');
                if (els.contentImg && els.contentImg.src) {
                els.contentImg.classList.remove('hidden');
                els.contentPlaceholder.classList.add('hidden');
                    // ÁîªÂÉè„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÜçË™øÊï¥
                    setTimeout(() => updateImageSize(), 100);
                } else {
                    if (els.contentImg) els.contentImg.classList.add('hidden');
                    if (els.contentPlaceholder) els.contentPlaceholder.classList.remove('hidden');
                }
            } else if (mode === 'preset') {
                if (els.contentPlaceholder) els.contentPlaceholder.classList.add('hidden');
                // „Çø„Ç§„É†„É©„Ç§„É≥„ÅÆÂ†¥Âêà„ÅØÁîªÂÉè„ÇíË°®Á§∫„ÄÅ„Åù„Çå‰ª•Â§ñ„ÅØHTML„ÇíË°®Á§∫
                if (state.lastPreset === 'timeline') {
                    if (els.contentHtml) els.contentHtml.classList.add('hidden');
                    applyPreset('timeline');
                } else {
                    if (els.contentImg) els.contentImg.classList.add('hidden');
                    if (els.contentHtml) els.contentHtml.classList.remove('hidden');
                applyPreset(state.lastPreset); 
                }
            } else if (mode === 'builder') {
                if (els.contentImg) els.contentImg.classList.add('hidden');
                if (els.contentPlaceholder) els.contentPlaceholder.classList.add('hidden');
                if (els.contentHtml) els.contentHtml.classList.remove('hidden');
                applyBuilder(state.lastBuilder);
            } else if (mode === 'test') {
                if (els.contentImg) els.contentImg.classList.add('hidden');
                if (els.contentPlaceholder) els.contentPlaceholder.classList.add('hidden');
                if (els.contentHtml) els.contentHtml.classList.remove('hidden');
                if (state.lastTest) {
                    applyTest(state.lastTest);
                }
            }
        }

        // --- Image Upload & Cropper (Unchanged logic) ---
        function handleImageUpload(input) {
            if (!els.cropperImg) return;
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    if (els.cropperImg) {
                    els.cropperImg.src = e.target.result;
                    openModal();
                    }
                };
                reader.readAsDataURL(input.files[0]);
            }
            input.value = '';
        }

        function openModal() {
            if (!els.modal || !els.cropperImg) return;
            els.modal.classList.remove('hidden');
            if (state.cropper) state.cropper.destroy();
            const image = els.cropperImg;
            const ar = config.aspectRatio;
            state.cropper = new Cropper(image, { aspectRatio: ar || NaN, viewMode: 1, autoCropArea: 1, background: false });
        }

        function closeCropper() {
            if (!els.modal) return;
            els.modal.classList.add('hidden');
            if (state.cropper) {
                state.cropper.destroy();
                state.cropper = null;
            }
        }

        function applyCrop() {
            if (!state.cropper || !els.contentImg || !els.contentPlaceholder) return;
            
            // PC„Çµ„Ç§„Ç∫„ÅßÂàá„ÇäÊäú„Åç
            const cropWidth = config.width * 2;
            const cropHeight = config.height * 2;
            
            const canvas = state.cropper.getCroppedCanvas({ 
                width: cropWidth, 
                height: cropHeight,
                fillColor: '#fff' 
            });
            
            els.contentImg.src = canvas.toDataURL('image/png');
            els.contentImg.classList.remove('hidden');
            els.contentPlaceholder.classList.add('hidden');
            closeCropper();
            
            // ÁîªÂÉèË™≠„ÅøËæº„ÅøÂæå„Å´„Çµ„Ç§„Ç∫„ÇíË™øÊï¥
            els.contentImg.onload = () => {
                setTimeout(() => updateImageSize(), 50);
            };
            if (els.contentImg.complete) {
                setTimeout(() => updateImageSize(), 50);
            }
        }

        // --- Content Generation Helpers ---
        const baseClass = "w-full h-full bg-gray-50 font-sans text-gray-800 overflow-hidden flex flex-col";
        
        // --- Common Components ---
        // PC_header: ÂÖ±ÈÄö„Éò„ÉÉ„ÉÄ„Éº„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà
        function createPCHeader() {
            return `
                <div class="bg-[#00aac2] w-full flex items-center justify-between px-8 py-4">
                    <!-- TUNAG„É≠„Ç¥ -->
                    <div class="flex items-center gap-2">
                        <div class="w-8 h-8 bg-white rounded flex items-center justify-center">
                            <span class="text-[#00aac2] font-bold text-xs">T</span>
                        </div>
                        <span class="text-white font-bold text-lg" contenteditable="true">TUNAG</span>
                    </div>
                    
                    <!-- „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„É°„Éã„É•„Éº -->
                    <div class="flex items-center gap-8">
                        <div class="flex items-center gap-2 text-white hover:opacity-80 cursor-pointer">
                            <i class="fa-solid fa-list-ul text-sm"></i>
                            <span class="font-semibold text-base" contenteditable="true">„Çø„Ç§„É†„É©„Ç§„É≥</span>
                        </div>
                        <div class="flex items-center gap-2 text-white hover:opacity-80 cursor-pointer">
                            <i class="fa-regular fa-comment-dots text-sm"></i>
                            <span class="font-semibold text-base" contenteditable="true">„ÉÅ„É£„ÉÉ„Éà</span>
                        </div>
                        <div class="flex items-center gap-2 text-white hover:opacity-80 cursor-pointer">
                            <i class="fa-solid fa-gift text-sm"></i>
                            <span class="font-semibold text-base" contenteditable="true">Âà∂Â∫¶</span>
                        </div>
                        <div class="flex items-center gap-2 text-white hover:opacity-80 cursor-pointer">
                            <i class="fa-solid fa-users text-sm"></i>
                            <span class="font-semibold text-base" contenteditable="true">ÁµÑÁπî</span>
                        </div>
                        <div class="flex items-center gap-2 text-white hover:opacity-80 cursor-pointer">
                            <i class="fa-solid fa-table-columns text-sm"></i>
                            <span class="font-semibold text-base" contenteditable="true">„Éù„Éº„Çø„É´</span>
                        </div>
                        <div class="flex items-center gap-2 text-white hover:opacity-80 cursor-pointer">
                            <i class="fa-solid fa-bell text-sm"></i>
                            <span class="font-semibold text-base" contenteditable="true">„ÅäÁü•„Çâ„Åõ</span>
                        </div>
                    </div>
                    
                    <!-- Âè≥ÂÅ¥„É°„Éã„É•„Éº -->
                    <div class="flex items-center gap-4">
                        <!-- Ê§úÁ¥¢„Ç¢„Ç§„Ç≥„É≥ -->
                        <div class="text-white hover:opacity-80 cursor-pointer">
                            <i class="fa-solid fa-search text-lg"></i>
                        </div>
                        
                        <!-- „Éó„É≠„Éï„Ç£„Éº„É´ -->
                        <div class="flex items-center gap-2 cursor-pointer">
                            <div class="w-8 h-8 rounded-full bg-cyan-200 flex items-center justify-center">
                                <i class="fa-solid fa-user text-cyan-600 text-xs"></i>
                            </div>
                            <i class="fa-solid fa-chevron-down text-white text-xs"></i>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // --- 1. Preset Logic (Rich Dummy Data) ---
        function applyPreset(type) {
            state.lastPreset = type;

            // Update UI Button Styles
            document.querySelectorAll('#content-preset .btn-select').forEach(btn => {
                // onclickÂ±ûÊÄß„Åã„ÇâÊ≠£Á¢∫„Å´„Éó„É™„Çª„ÉÉ„Éà„Çø„Ç§„Éó„ÇíÊäΩÂá∫„Åó„Å¶ÂÆåÂÖ®‰∏ÄËá¥„ÅßÂà§ÂÆö
                const onclickAttr = btn.getAttribute('onclick') || '';
                // applyPreset('type')„ÅÆÂΩ¢Âºè„Åã„Çâ'type'„ÇíÊäΩÂá∫
                const match = onclickAttr.match(/applyPreset\(['"]([^'"]+)['"]\)/);
                const buttonType = match ? match[1] : '';
                // ÂÆåÂÖ®‰∏ÄËá¥„ÅßÂà§ÂÆö
                if(buttonType === type) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // ÁîªÂÉè„Éó„É™„Çª„ÉÉ„Éà„ÅÆ„Éû„ÉÉ„Éî„É≥„Ç∞
            const imagePresets = {
                'timeline': 'preset/timeline_001_pc.png',
                'thankscard': 'preset/Âà∂Â∫¶Ë©≥Á¥∞_PC_„Çµ„É≥„ÇØ„Çπ„Ç´„Éº„Éâ.png',
                'company_notice': 'preset/Âà∂Â∫¶Ë©≥Á¥∞_PC_‰ºöÁ§æ„Åã„Çâ„ÅÆ„ÅäÁü•„Çâ„Åõ.png',
                'monthly_award': 'preset/Âà∂Â∫¶Ë©≥Á¥∞_PC_ÊúàÈñìË°®ÂΩ∞.png',
                'president_message': 'preset/Âà∂Â∫¶Ë©≥Á¥∞_PC_Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏.png',
                'post_company_notice': 'preset/ÊäïÁ®øË©≥Á¥∞_PC_‰ºöÁ§æ„Åã„Çâ„ÅÆ„ÅäÁü•„Çâ„Åõ.png',
                'post_president_message': 'preset/ÊäïÁ®øË©≥Á¥∞_PC_Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏.png'
            };
            
            // ÁîªÂÉè„Éó„É™„Çª„ÉÉ„Éà„ÅÆÂ†¥Âêà„ÅØÁîªÂÉè„ÇíË™≠„ÅøËæº„ÇÄ
            if (imagePresets[type]) {
                // PCÁîªÂÉè„Çí‰ΩøÁî®
                const imagePath = imagePresets[type];
                
                // ÁîªÂÉè„ÇíË°®Á§∫
                if (els.contentImg) {
                    // Êó¢Â≠ò„ÅÆonload„Ç§„Éô„É≥„Éà„Çí„ÇØ„É™„Ç¢
                    els.contentImg.onload = null;
                    
                    // Êñ∞„Åó„ÅÑÁîªÂÉè„ÇíË™≠„ÅøËæº„ÇÄ
                    const img = new Image();
                    img.onload = () => {
                        els.contentImg.src = imagePath;
                        els.contentImg.classList.remove('hidden');
                        els.contentPlaceholder.classList.add('hidden');
                        if (els.contentHtml) els.contentHtml.classList.add('hidden');
                        // „Çµ„Ç§„Ç∫„ÇíË™øÊï¥
                        setTimeout(() => updateImageSize(), 50);
                    };
                    img.onerror = () => {
                        console.error('ÁîªÂÉè„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:', imagePath);
                    };
                    img.src = imagePath;
                }
                return;
            }
            
            // „Åù„ÅÆ‰ªñ„ÅÆ„Éó„É™„Çª„ÉÉ„Éà„ÅØHTML„ÇíÁîüÊàê
            let html = '';
            
            if (type === 'chat') {
                html = `
                    <div class="${baseClass}">
                        <!-- PC_header: ÂÖ±ÈÄö„Éò„ÉÉ„ÉÄ„Éº„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà -->
                        ${createPCHeader()}
                        <div class="flex-1 overflow-y-auto bg-gray-50 flex">
                            <!-- Â∑¶„Çµ„Ç§„Éâ„Éê„Éº -->
                            <div class="w-80 bg-white border-r border-gray-200 flex flex-col">
                                <!-- PC_profile: „Éó„É≠„Éï„Ç£„Éº„É´„Ç´„Éº„Éâ -->
                                <div class="bg-white rounded-lg m-4 mb-3 overflow-hidden shadow-sm">
                                    <div class="h-48 bg-gradient-to-br from-blue-400 to-purple-400 relative">
                                        <div class="absolute bottom-0 left-4 transform translate-y-1/2">
                                            <div class="w-20 h-20 rounded-full bg-cyan-200 border-4 border-white flex items-center justify-center">
                                                <i class="fa-solid fa-user text-cyan-600 text-2xl"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="pt-10 pb-4 px-4">
                                        <div class="font-bold text-gray-700 text-lg mb-1" contenteditable="true">‰ΩêËó§ ÈôΩËèú</div>
                                        <div class="text-gray-500 text-sm" contenteditable="true">Ê†™Âºè‰ºöÁ§æ„Çπ„Çø„É°„É≥Ôºè‰∫∫‰∫ãÈÉ®</div>
                                        <div class="text-gray-500 text-sm" contenteditable="true">Êé°Áî®„Ç∞„É´„Éº„Éó</div>
                                    </div>
                                </div>
                                
                                <!-- PC_point: „Éù„Ç§„É≥„ÉàË°®Á§∫ -->
                                <div class="bg-white rounded-lg mx-4 mb-3 p-4 shadow-sm">
                                    <div class="flex items-center justify-between">
                                        <div class="text-gray-700 font-medium" contenteditable="true">ÁèæÂú®„ÅÆ„Éù„Ç§„É≥„Éà</div>
                                        <div class="text-tunag-cyan font-bold text-2xl" contenteditable="true">125 <span class="text-lg">pt‚≠ê</span></div>
                                    </div>
                                </div>
                                
                                <!-- PC_pickup: „Éî„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Ç¢„Ç§„ÉÜ„É† -->
                                <div class="flex-1 overflow-y-auto px-4 space-y-3">
                                    <div class="flex items-center gap-4 p-3 bg-white rounded-lg shadow-sm">
                                        <div class="w-20 h-20 rounded-xl bg-gradient-to-br from-green-400 to-teal-400 flex items-center justify-center shrink-0">
                                            <i class="fa-solid fa-tasks text-white text-xl"></i>
                                        </div>
                                        <div class="font-medium text-gray-700" contenteditable="true">„Çø„Çπ„ÇØ</div>
                                    </div>
                                    <div class="flex items-center gap-4 p-3 bg-white rounded-lg shadow-sm">
                                        <div class="w-20 h-20 rounded-xl bg-gradient-to-br from-pink-400 to-red-400 flex items-center justify-center shrink-0">
                                            <i class="fa-solid fa-star text-white text-xl"></i>
                                        </div>
                                        <div class="font-medium text-gray-700" contenteditable="true">Ê≥®ÁõÆ„ÅÆÊäïÁ®ø</div>
                                    </div>
                                    <div class="flex items-center gap-4 p-3 bg-white rounded-lg shadow-sm">
                                        <div class="w-20 h-20 rounded-xl bg-gradient-to-br from-yellow-400 to-orange-400 flex items-center justify-center shrink-0">
                                            <i class="fa-solid fa-bookmark text-white text-xl"></i>
                                        </div>
                                        <div class="font-medium text-gray-700" contenteditable="true">„Éñ„ÉÉ„ÇØ„Éû„Éº„ÇØ</div>
                                    </div>
                                    <div class="flex items-center gap-4 p-3 bg-white rounded-lg shadow-sm">
                                        <div class="w-20 h-20 rounded-xl bg-gradient-to-br from-blue-400 to-indigo-400 flex items-center justify-center shrink-0">
                                            <i class="fa-solid fa-envelope text-white text-xl"></i>
                                        </div>
                                        <div class="font-medium text-gray-700" contenteditable="true">Êú™Ë™≠„ÅÆÊäïÁ®ø</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ -->
                            <div class="flex-1 overflow-y-auto">
                                <!-- „É¶„Éº„Ç∂„ÉºÊÉÖÂ†± -->
                                <div class="bg-white flex items-center gap-3 px-6 pt-6 pb-2.5">
                                    <div class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center shrink-0">
                                        <i class="fa-solid fa-user text-red-500 text-xs"></i>
                                    </div>
                                    <div class="flex flex-col">
                                        <div class="font-bold text-gray-700 text-lg" contenteditable="true">Èà¥Êú® ‰∏ÄÁßÄ</div>
                                        <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 9:21</div>
                                    </div>
                                </div>
                                
                                <!-- Ê≥®ÊÑè„É°„ÉÉ„Çª„Éº„Ç∏ -->
                                <div class="bg-white px-6 py-4 border-b border-gray-100">
                                    <div class="flex items-center gap-2">
                                        <span class="text-cyan-500 font-medium text-lg" contenteditable="true">Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏</span>
                                        <span class="text-gray-700 font-normal text-lg" contenteditable="true">„ÇíÂÖ¨Èñã„Åó„Åæ„Åó„ÅüÔºÅ</span>
                                    </div>
                                </div>
                                
                                <!-- „ÉÜ„Ç≠„Çπ„Éà„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
                                <div class="bg-white px-6 py-4 border-b border-gray-100">
                                    <div class="space-y-3 text-gray-700">
                                        <p class="text-base leading-relaxed" contenteditable="true">ÁöÜ„Åï„Çì„ÄÅ„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ</p>
                                        <p class="text-base leading-relaxed" contenteditable="true">Êú¨Êó•„ÅØ„ÄÅÁßÅ„ÅåÂ§ßÂàá„Å´„Åó„Å¶„ÅÑ„Çã„Äå„Çâ„Åó„ÅèÂÉç„Åè„Äç„Å®„ÅÑ„ÅÜ„ÉÜ„Éº„Éû„Å´„Å§„ÅÑ„Å¶„ÄÅ„ÅäË©±„Åó„Åï„Åõ„Å¶„ÅÑ„Åü„Å†„Åç„Åæ„Åô„ÄÇ</p>
                                        <p class="text-base leading-relaxed" contenteditable="true">ÁßÅ„Åü„Å°„ÅØ„ÄÅ‰∏Ä‰∫∫„Å≤„Å®„Çä„ÅåÊåÅ„Å§ÂÄãÊÄß„ÇÑÂº∑„Åø„ÇíÊ¥ª„Åã„Åó„Å™„Åå„Çâ„ÄÅ„ÉÅ„Éº„É†„Å®„Åó„Å¶ÊàêÊûú„ÇíÂá∫„Åó„Å¶„ÅÑ„Åè„Åì„Å®„ÅåÈáçË¶Å„Å†„Å®ËÄÉ„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
                                        <p class="text-base leading-relaxed" contenteditable="true">„Åù„Çå„Åû„Çå„ÅÆ„Äå„Çâ„Åó„Åï„Äç„ÇíÂ∞äÈáç„Åó„ÄÅ„Åä‰∫í„ÅÑ„ÇíÁêÜËß£„ÅóÂêà„ÅÜ„Åì„Å®„Åß„ÄÅ„Çà„ÇäËâØ„ÅÑËÅ∑Â†¥Áí∞Â¢É„ÅåÁîü„Åæ„Çå„Åæ„Åô„ÄÇ</p>
                                        <p class="text-base leading-relaxed mt-4" contenteditable="true">‰ªäÂπ¥„ÇÇ„ÄÅÁöÜ„Åï„Çì‰∏Ä‰∫∫„Å≤„Å®„Çä„Åå„Äå„Çâ„Åó„ÅèÂÉç„Åè„Äç„Åì„Å®„Åå„Åß„Åç„Çã„Çà„ÅÜ„ÄÅÂÖ®Âäõ„Åß„Çµ„Éù„Éº„Éà„Åó„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ‰∏ÄÁ∑í„Å´È†ëÂºµ„Çä„Åæ„Åó„Çá„ÅÜÔºÅ</p>
                                    </div>
                                </div>
                                
                                <!-- „É°„É≥„Éê„ÉºÊÉÖÂ†± -->
                                <div class="bg-white px-6 py-4 border-b border-gray-100">
                                    <div class="space-y-4">
                                        <!-- „É°„É≥„Éê„Éº„Ç´„Éº„Éâ1 -->
                                        <div class="border border-gray-200 rounded-lg p-4">
                                            <div class="flex items-center gap-6">
                                                <div class="w-18 h-18 rounded-full bg-yellow-100 flex items-center justify-center shrink-0">
                                                    <i class="fa-solid fa-user text-yellow-600"></i>
                                                </div>
                                                <div class="flex flex-col">
                                                    <div class="font-bold text-gray-700 text-lg" contenteditable="true">Áî∞‰∏≠ ÂÑ™Âä©</div>
                                                    <div class="text-gray-500 text-sm" contenteditable="true">‰∫ãÊ•≠Ê≥ï‰∫∫ Á¨¨‰∏âÈÉ®</div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- „É°„É≥„Éê„Éº„Ç´„Éº„Éâ2 -->
                                        <div class="border border-gray-200 rounded-lg p-4">
                                            <div class="flex items-center gap-6">
                                                <div class="w-18 h-18 rounded-full bg-green-100 flex items-center justify-center shrink-0">
                                                    <i class="fa-solid fa-user text-green-600"></i>
                                                </div>
                                                <div class="flex flex-col">
                                                    <div class="font-bold text-gray-700 text-lg" contenteditable="true">ÂêâÂ∑ù ÁæéÁ¥óÂ≠ê</div>
                                                    <div class="text-gray-500 text-sm" contenteditable="true">„Ç§„É≥„Çµ„Ç§„Éâ„Çª„Éº„É´„ÇπÈÉ®</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ÂÜôÁúü -->
                                <div class="bg-white px-6 py-6 border-b border-gray-100">
                                    <div class="w-full h-96 bg-gray-200 rounded-xl flex items-center justify-center">
                                        <i class="fa-solid fa-image text-gray-400 text-4xl"></i>
                                    </div>
                                </div>
                                
                                <!-- „Ç´„ÉÜ„Ç¥„É™ -->
                                <div class="bg-white px-6 py-5 border-b border-gray-100 flex items-center gap-6">
                                    <div class="w-23 h-23 rounded-2xl bg-yellow-400 flex items-center justify-center shrink-0">
                                        <i class="fa-solid fa-bullhorn text-white text-sm"></i>
                                    </div>
                                    <div class="flex flex-col">
                                        <div class="font-bold text-gray-700 text-lg mb-1" contenteditable="true">Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏</div>
                                        <div class="text-gray-600 text-base" contenteditable="true">Èà¥Êú®Á§æÈï∑„Åå‰∫ãÊ•≠„ÇÑ‰ºöÁ§æ„Å∏„ÅÆÊÄù„ÅÑ„Çí‰ºù„Åà„Åæ„Åôüî•</div>
                                    </div>
                                </div>
                                
                                <!-- „É™„Ç¢„ÇØ„Ç∑„Éß„É≥ -->
                                <div class="bg-white px-6 py-1 border-b border-gray-100 flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <!-- „É™„Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
                                        <div class="flex items-center gap-2">
                                            <div class="border-2 border-cyan-500 rounded-full px-3 py-2 flex items-center">
                                                <i class="fa-regular fa-heart text-cyan-500 text-sm"></i>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center">
                                                    <i class="fa-regular fa-face-smile text-gray-500 text-xs"></i>
                                                </div>
                                                <span class="text-gray-700 font-bold text-lg">1</span>
                                            </div>
                                            <div class="bg-gray-100 rounded-full px-3 py-2">
                                                <i class="fa-regular fa-comment text-gray-500 text-sm"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <!-- Êó¢Ë™≠„É¶„Éº„Ç∂„Éº -->
                                        <div class="flex -space-x-2">
                                            <div class="w-8 h-8 rounded-full bg-red-500 border-2 border-white"></div>
                                            <div class="w-8 h-8 rounded-full bg-pink-400 border-2 border-white"></div>
                                            <div class="w-8 h-8 rounded-full bg-green-500 border-2 border-white"></div>
                                            <div class="w-8 h-8 rounded-full bg-orange-400 border-2 border-white"></div>
                                            <div class="w-8 h-8 rounded-full bg-blue-400 border-2 border-white"></div>
                                        </div>
                                        <span class="text-cyan-500 text-sm" contenteditable="true">Êó¢Ë™≠ <span class="font-bold">31</span>‰∫∫</span>
                                    </div>
                                </div>
                                
                                <!-- „Ç≥„É°„É≥„Éà -->
                                <div class="bg-white">
                                    <!-- „Ç≥„É°„É≥„Éà1 -->
                                    <div class="px-6 py-6 border-b border-gray-100">
                                        <div class="flex items-start gap-4">
                                            <div class="w-4 h-4 rounded-full bg-green-100 flex items-center justify-center shrink-0 mt-1">
                                                <i class="fa-solid fa-user text-green-600 text-xs"></i>
                                            </div>
                                            <div class="flex-1">
                                                <div class="flex items-end gap-5 mb-1">
                                                    <div class="font-medium text-gray-700 text-base" contenteditable="true">ÂêâÂ∑ù ÁæéÁ¥óÂ≠ê</div>
                                                    <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 10:01</div>
                                                </div>
                                                <div class="text-gray-700 text-lg leading-relaxed" contenteditable="true">"„Çâ„Åó„ÅèÂÉç„Åè"„Å£„Å¶„ÄÅÊäΩË±°ÁöÑ„Å†„Åë„Å©Â••Ê∑±„ÅÑË®ÄËëâ„Åß„Åô„Å≠„ÄÇ<br>„ÉÅ„Éº„É†„Å®„Åó„Å¶„Å©„ÅÜÂú®„Çå„Çã„Åã„ÄÅËÄÉ„Åà„Å¶„Åø„Åü„Åè„Å™„Çä„Åæ„Åó„ÅüÔºÅ</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- „Ç≥„É°„É≥„Éà2 -->
                                    <div class="px-6 py-6 border-b border-gray-100">
                                        <div class="flex items-start gap-4">
                                            <div class="w-4 h-4 rounded-full bg-blue-100 flex items-center justify-center shrink-0 mt-1">
                                                <i class="fa-solid fa-user text-blue-600 text-xs"></i>
                                            </div>
                                            <div class="flex-1">
                                                <div class="flex items-end gap-5 mb-1">
                                                    <div class="font-medium text-gray-700 text-base" contenteditable="true">Â±±Áî∞ Â§™ÈÉé</div>
                                                    <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 10:15</div>
                                                </div>
                                                <div class="text-gray-700 text-lg leading-relaxed" contenteditable="true">Á§æÈï∑„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏„ÄÅ„Å®„Å¶„ÇÇÂÖ±ÊÑü„Åó„Åæ„Åó„Åü„ÄÇËá™ÂàÜ„Çâ„Åó„Åï„ÇíÂ§ßÂàá„Å´„Åó„Å™„Åå„Çâ„ÄÅ„ÉÅ„Éº„É†„ÅÆ‰∏ÄÂì°„Å®„Åó„Å¶Ë≤¢ÁåÆ„Åó„Å¶„ÅÑ„Åç„Åü„ÅÑ„Åß„Åô„ÄÇ</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- „Ç≥„É°„É≥„Éà3 -->
                                    <div class="px-6 py-6">
                                        <div class="flex items-start gap-4">
                                            <div class="w-4 h-4 rounded-full bg-purple-100 flex items-center justify-center shrink-0 mt-1">
                                                <i class="fa-solid fa-user text-purple-600 text-xs"></i>
                                            </div>
                                            <div class="flex-1">
                                                <div class="flex items-end gap-5 mb-1">
                                                    <div class="font-medium text-gray-700 text-base" contenteditable="true">‰ΩêËó§ Ëä±Â≠ê</div>
                                                    <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 10:30</div>
                                                </div>
                                                <div class="text-gray-700 text-lg leading-relaxed" contenteditable="true">‰ªäÂπ¥„ÇÇ„Çà„Çç„Åó„Åè„ÅäÈ°ò„ÅÑ„Åó„Åæ„ÅôÔºÅ‰∏Ä‰∫∫„Å≤„Å®„Çä„ÅÆÂÄãÊÄß„ÇíÊ¥ª„Åã„Åõ„ÇãËÅ∑Â†¥Áí∞Â¢É„Çí„ÄÅ„Åø„Çì„Å™„Åß‰Ωú„Å£„Å¶„ÅÑ„Åç„Åæ„Åó„Çá„ÅÜ„ÄÇ</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Âè≥„Çµ„Ç§„Éâ„Éê„Éº -->
                            <div class="w-80 bg-white border-l border-gray-200 flex flex-col">
                                <!-- PC_mustread: ÂøÖË™≠ÊäïÁ®ø -->
                                <div class="m-4 mb-3 bg-white rounded-lg overflow-hidden shadow-sm">
                                    <div class="bg-white px-4 py-3 flex items-center justify-between border-b border-gray-200">
                                        <div class="font-bold text-gray-700" contenteditable="true">ÂøÖË™≠ÊäïÁ®ø</div>
                                        <div class="flex items-center gap-1 text-gray-600 text-sm cursor-pointer">
                                            <span contenteditable="true">„Åô„Åπ„Å¶Ë¶ã„Çã</span>
                                            <i class="fa-solid fa-chevron-right text-xs"></i>
                                        </div>
                                    </div>
                                    <div class="h-64 bg-orange-400 relative overflow-hidden">
                                        <div class="absolute inset-0 bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center">
                                            <i class="fa-solid fa-image text-white text-6xl opacity-50"></i>
                                        </div>
                                        <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-60 px-4 py-3">
                                            <div class="text-white font-bold text-center" contenteditable="true">‰ªäÈÄ±„ÅÆ„Éô„Çπ„ÉàÊäïÁ®ø</div>
                                        </div>
                                    </div>
                                    <div class="bg-white px-4 py-3 flex items-center justify-between">
                                        <div class="flex items-center gap-2">
                                            <span class="bg-red-500 text-white text-xs px-2 py-1 rounded" contenteditable="true">UPDATE</span>
                                            <span class="text-gray-600 text-sm" contenteditable="true">4Êúà28Êó•</span>
                                        </div>
                                        <div class="text-cyan-600 font-bold text-sm cursor-pointer" contenteditable="true">Á¢∫Ë™ç„Åô„Çã <i class="fa-solid fa-chevron-right text-xs"></i></div>
                                    </div>
                                    <div class="flex justify-center gap-2 pb-3">
                                        <div class="w-2 h-2 rounded-full bg-cyan-500"></div>
                                        <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                        <div class="w-2 h-2 rounded-full bg-gray-300"></div>
                                    </div>
                                </div>
                                
                                <!-- PC_menu: „É°„Éã„É•„Éº -->
                                <div class="mx-4 mb-3 bg-white rounded-lg p-4 shadow-sm">
                                    <div class="flex items-center gap-4">
                                        <div class="w-12 h-12 rounded bg-blue-500 flex items-center justify-center shrink-0">
                                            <i class="fa-solid fa-envelope text-white"></i>
                                        </div>
                                        <div class="font-medium text-gray-700" contenteditable="true">„É°„Éº„É´</div>
                                    </div>
                                </div>
                                
                                <!-- PC_notice: „ÅäÁü•„Çâ„Åõ -->
                                <div class="flex-1 overflow-y-auto px-4 space-y-3">
                                    <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200">
                                        <div class="font-bold text-sm text-gray-700 mb-1" contenteditable="true">„ÅäÁü•„Çâ„Åõ„Çø„Ç§„Éà„É´1</div>
                                        <div class="text-xs text-gray-500" contenteditable="true">„ÅäÁü•„Çâ„Åõ„ÅÆÂÜÖÂÆπ„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô...</div>
                                    </div>
                                    <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200">
                                        <div class="font-bold text-sm text-gray-700 mb-1" contenteditable="true">„ÅäÁü•„Çâ„Åõ„Çø„Ç§„Éà„É´2</div>
                                        <div class="text-xs text-gray-500" contenteditable="true">„ÅäÁü•„Çâ„Åõ„ÅÆÂÜÖÂÆπ„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô...</div>
                                    </div>
                                    <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200">
                                        <div class="font-bold text-sm text-gray-700 mb-1" contenteditable="true">„ÅäÁü•„Çâ„Åõ„Çø„Ç§„Éà„É´3</div>
                                        <div class="text-xs text-gray-500" contenteditable="true">„ÅäÁü•„Çâ„Åõ„ÅÆÂÜÖÂÆπ„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô...</div>
                                    </div>
                                    <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200">
                                        <div class="font-bold text-sm text-gray-700 mb-1" contenteditable="true">„ÅäÁü•„Çâ„Åõ„Çø„Ç§„Éà„É´4</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
            } else if (type === 'chat') {
                html = `
                     <div class="${baseClass}">
                        <div class="h-14 bg-white border-b flex items-center px-4 gap-3 shrink-0">
                            <i class="fa-solid fa-arrow-left text-gray-400"></i>
                            <div class="font-bold flex-1" contenteditable="true">Âñ∂Ê•≠ÈÉ®„Ç∞„É´„Éº„Éó (8)</div>
                            <i class="fa-solid fa-bars text-gray-400"></i>
                        </div>
                        <div class="flex-1 p-4 space-y-4 overflow-y-auto bg-blue-50/30">
                            <div class="text-center text-xs text-gray-400 my-2">‰ªäÊó•</div>
                            <div class="flex gap-2">
                                <div class="w-8 h-8 rounded-full bg-gray-200 shrink-0"></div>
                                <div>
                                    <div class="text-[10px] text-gray-500 mb-0.5">‰ΩêËó§„Åï„Çì</div>
                                    <div class="bg-white p-2.5 rounded-r-lg rounded-bl-lg shadow-sm border text-sm" contenteditable="true">„ÅäÁñ≤„ÇåÊßò„Åß„ÅôÔºÅ‰æã„ÅÆË≥áÊñôÁ¢∫Ë™ç„Åó„Åæ„Åó„Åü„ÄÇ</div>
                                </div>
                            </div>
                            <div class="flex gap-2 flex-row-reverse">
                                <div class="bg-tunag-blue text-white p-2.5 rounded-l-lg rounded-br-lg shadow-sm text-sm max-w-[80%]" contenteditable="true">„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ<br>‰øÆÊ≠£„Åó„Å¶ÂÜçÈÄÅ„Åó„Åæ„Åô„Å≠„ÄÇ</div>
                            </div>
                        </div>
                        <div class="h-14 bg-white border-t px-3 flex items-center gap-2 shrink-0">
                            <i class="fa-solid fa-plus text-gray-400"></i>
                            <div class="flex-1 h-9 bg-gray-100 rounded px-2 flex items-center text-sm text-gray-400">„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂÖ•Âäõ...</div>
                            <i class="fa-solid fa-paper-plane text-tunag-blue"></i>
                        </div>
                    </div>`;
            } else if (type === 'menu') {
                html = `
                    <div class="${baseClass}">
                        <div class="bg-tunag-blue p-5 text-white pb-10">
                            <div class="font-bold text-xl mb-1" contenteditable="true">TUNAG Demo Inc.</div>
                            <div class="text-sm opacity-80" contenteditable="true">„Ç®„É≥„Ç≤„Éº„Ç∏„É°„É≥„ÉàÁµåÂñ∂„ÇíÂÆüË∑µ‰∏≠</div>
                        </div>
                        <div class="flex-1 bg-gray-50 -mt-6 rounded-t-xl px-4 pt-6 space-y-3 overflow-y-auto">
                            <div class="flex justify-between mb-4 px-2">
                                <div class="text-center"><div class="w-12 h-12 bg-white rounded-full shadow flex items-center justify-center text-tunag-blue mb-1 mx-auto"><i class="fa-solid fa-list"></i></div><span class="text-xs">Âà∂Â∫¶‰∏ÄË¶ß</span></div>
                                <div class="text-center"><div class="w-12 h-12 bg-white rounded-full shadow flex items-center justify-center text-orange-500 mb-1 mx-auto"><i class="fa-solid fa-gift"></i></div><span class="text-xs">„Éù„Ç§„É≥„Éà</span></div>
                                <div class="text-center"><div class="w-12 h-12 bg-white rounded-full shadow flex items-center justify-center text-green-500 mb-1 mx-auto"><i class="fa-solid fa-users"></i></div><span class="text-xs">ÁµÑÁπîÂõ≥</span></div>
                                <div class="text-center"><div class="w-12 h-12 bg-white rounded-full shadow flex items-center justify-center text-purple-500 mb-1 mx-auto"><i class="fa-solid fa-user"></i></div><span class="text-xs">Ëá™ÂàÜ</span></div>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between">
                                <span class="font-bold text-sm">„ÅäÁü•„Çâ„Åõ</span>
                                <span class="w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center">3</span>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between">
                                <span class="font-bold text-sm">Êú™Ë™≠„ÅÆ„ÉÅ„É£„ÉÉ„Éà</span>
                                <i class="fa-solid fa-chevron-right text-gray-300"></i>
                            </div>
                        </div>
                    </div>`;
            } else if (type === 'profile') {
                html = `
                    <div class="${baseClass}">
                        <div class="h-32 bg-gray-300 relative">
                            <div class="absolute -bottom-10 left-4 w-20 h-20 bg-white rounded-full p-1 shadow">
                                <div class="w-full h-full bg-gray-200 rounded-full flex items-center justify-center"><i class="fa-solid fa-user text-2xl text-gray-400"></i></div>
                            </div>
                        </div>
                        <div class="mt-12 px-4 pb-4 overflow-y-auto">
                            <h2 class="text-lg font-bold" contenteditable="true">Â±±Áî∞ Â§™ÈÉé</h2>
                            <p class="text-xs text-gray-500 mb-4" contenteditable="true">Âñ∂Ê•≠ÈÉ® / „Éû„Éç„Éº„Ç∏„É£„Éº</p>
                            
                            <div class="space-y-3">
                                <div class="bg-white p-3 rounded border border-gray-200">
                                    <div class="text-xs text-gray-400 mb-1">Ëá™Â∑±Á¥π‰ªã</div>
                                    <div class="text-sm" contenteditable="true">‰ºëÊó•„ÅØË∂£Âë≥„ÅÆ„Ç≠„É£„É≥„Éó„Å´Ë°å„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Çà„Çç„Åó„Åè„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô„ÄÇ</div>
                                </div>
                                <div class="bg-white p-3 rounded border border-gray-200 flex justify-between items-center">
                                    <span class="text-sm font-bold">„Çµ„É≥„ÇØ„Çπ„Ç´„Éº„Éâ</span>
                                    <span class="text-tunag-blue font-bold">120Êûö</span>
                                </div>
                            </div>
                        </div>
                    </div>`;
            } else if (type === 'calendar') {
                html = `
                    <div class="${baseClass}">
                        <div class="h-14 bg-white border-b flex items-center px-4 justify-between shrink-0">
                            <i class="fa-solid fa-chevron-left text-gray-400"></i>
                            <div class="font-bold">2023Âπ¥ 10Êúà</div>
                            <i class="fa-solid fa-chevron-right text-gray-400"></i>
                        </div>
                        <div class="flex-1 p-4 overflow-y-auto">
                            <!-- Calendar Grid Dummy -->
                            <div class="grid grid-cols-7 gap-1 mb-4 text-center text-xs text-gray-500">
                                <span>Êó•</span><span>Êúà</span><span>ÁÅ´</span><span>Ê∞¥</span><span>Êú®</span><span>Èáë</span><span>Âúü</span>
                                <span class="p-2 text-gray-300">29</span><span class="p-2 text-gray-300">30</span><span class="p-2">1</span><span class="p-2">2</span><span class="p-2">3</span><span class="p-2">4</span><span class="p-2 text-blue-500">5</span>
                                <span class="p-2">6</span><span class="p-2">7</span><span class="p-2">8</span><span class="p-2">9</span><span class="p-2 bg-blue-100 rounded-full text-blue-600 font-bold">10</span><span class="p-2">11</span><span class="p-2 text-blue-500">12</span>
                            </div>
                            <div class="space-y-2">
                                <div class="text-xs font-bold text-gray-500 mb-2">10Êúà10Êó• (ÁÅ´)</div>
                                <div class="bg-white p-3 rounded border-l-4 border-tunag-blue shadow-sm">
                                    <div class="text-xs text-gray-400">10:00 - 11:00</div>
                                    <div class="font-bold text-sm" contenteditable="true">ÂÖ®Á§æ„Éü„Éº„ÉÜ„Ç£„É≥„Ç∞</div>
                                </div>
                                <div class="bg-white p-3 rounded border-l-4 border-green-500 shadow-sm">
                                    <div class="text-xs text-gray-400">14:00 - 15:00</div>
                                    <div class="font-bold text-sm" contenteditable="true">1on1 (‰ΩêËó§)</div>
                                </div>
                            </div>
                        </div>
                    </div>`;
            } else if (type === 'notice') {
                html = `
                    <div class="${baseClass}">
                         <div class="h-14 bg-white border-b flex items-center px-4 gap-3 shrink-0">
                            <i class="fa-solid fa-arrow-left text-gray-400"></i>
                            <div class="font-bold flex-1">„ÅäÁü•„Çâ„Åõ</div>
                        </div>
                        <div class="flex-1 overflow-y-auto">
                            <div class="bg-white p-4 border-b flex gap-3 hover:bg-gray-50">
                                <div class="w-2 h-2 rounded-full bg-red-500 mt-2 shrink-0"></div>
                                <div>
                                    <div class="text-xs text-gray-400 mb-1">ÈÅãÂñ∂‰∫ãÂãôÂ±Ä - 2023/10/10</div>
                                    <div class="font-bold text-sm mb-1" contenteditable="true">„Ç∑„Çπ„ÉÜ„É†„É°„É≥„ÉÜ„Éä„É≥„Çπ„ÅÆ„ÅäÁü•„Çâ„Åõ</div>
                                    <div class="text-xs text-gray-500">10/15 AM2:00„Çà„Çä„É°„É≥„ÉÜ„Éä„É≥„Çπ„ÇíÂÆüÊñΩ„Åó„Åæ„Åô„ÄÇ</div>
                                </div>
                            </div>
                            <div class="bg-white p-4 border-b flex gap-3 hover:bg-gray-50">
                                <div class="w-2 h-2 rounded-full bg-transparent mt-2 shrink-0"></div>
                                <div>
                                    <div class="text-xs text-gray-400 mb-1">‰∫∫‰∫ãÈÉ® - 2023/10/05</div>
                                    <div class="font-bold text-sm mb-1" contenteditable="true">ÂÅ•Â∫∑Ë®∫Êñ≠„ÅÆÂèóË®∫„Å´„Å§„ÅÑ„Å¶</div>
                                </div>
                            </div>
                        </div>
                    </div>`;
            }
            if (els.contentHtml) {
            els.contentHtml.innerHTML = html;
            }
        }

        // --- Test Logic ---
        function applyTest(type) {
            state.lastTest = type;
            
            // Update UI Button Styles
            document.querySelectorAll('#content-test .btn-select').forEach(btn => {
                const onclickAttr = btn.getAttribute('onclick') || '';
                const match = onclickAttr.match(/applyTest\(['"]([^'"]+)['"]\)/);
                const buttonType = match ? match[1] : '';
                if(buttonType === type) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            let html = '';
            
            if (type === 'test_timeline') {
                html = `
                    <div class="${baseClass}">
                        <!-- PC_header: ÂÖ±ÈÄö„Éò„ÉÉ„ÉÄ„Éº„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà -->
                        ${createPCHeader()}
                        <div class="flex-1 overflow-y-auto bg-gray-50 flex">
                            <!-- Â∑¶„Çµ„Ç§„Éâ„Éê„Éº -->
                            <div class="w-96 bg-white border-r border-gray-200 flex flex-col shrink-0">
                                <!-- PC_profile: „Éó„É≠„Éï„Ç£„Éº„É´„Ç´„Éº„Éâ -->
                                <div class="bg-white rounded-lg m-5 mb-4 overflow-hidden shadow-sm">
                                    <div class="h-64 bg-gray-300 relative overflow-hidden">
                                        <!-- ËÉåÊôØÁîªÂÉè„ÅÆ„Éó„É¨„Éº„Çπ„Éõ„É´„ÉÄ„Éº -->
                                        <div class="absolute inset-0 bg-gradient-to-br from-blue-100 via-purple-100 to-pink-100"></div>
                                        <div class="absolute inset-0 flex items-center justify-center opacity-20">
                                            <i class="fa-solid fa-building text-gray-400 text-6xl"></i>
                                        </div>
                                        <!-- „Éó„É≠„Éï„Ç£„Éº„É´„Ç¢„Ç§„Ç≥„É≥ -->
                                        <div class="absolute bottom-0 left-5 transform translate-y-1/2">
                                            <div class="w-24 h-24 rounded-full bg-cyan-200 border-4 border-white flex items-center justify-center shadow-md">
                                                <i class="fa-solid fa-user text-cyan-600 text-3xl"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="pt-14 pb-5 px-5">
                                        <div class="font-bold text-gray-700 text-xl mb-1" contenteditable="true">‰ΩêËó§ ÈôΩËèú</div>
                                        <div class="text-gray-500 text-sm mb-0.5" contenteditable="true">Ê†™Âºè‰ºöÁ§æ„Çπ„Çø„É°„É≥Ôºè‰∫∫‰∫ãÈÉ®</div>
                                        <div class="text-gray-500 text-sm" contenteditable="true">Êé°Áî®„Ç∞„É´„Éº„Éó</div>
                                    </div>
                                </div>
                                
                                <!-- PC_point: „Éù„Ç§„É≥„ÉàË°®Á§∫ -->
                                <div class="bg-white rounded-lg mx-5 mb-4 p-5 shadow-sm">
                                    <div class="flex items-center justify-between">
                                        <div class="text-gray-700 font-medium text-base" contenteditable="true">ÁèæÂú®„ÅÆ„Éù„Ç§„É≥„Éà</div>
                                        <div class="text-tunag-cyan font-bold text-3xl" contenteditable="true">125 <span class="text-xl">pt‚≠ê</span></div>
                                    </div>
                                </div>
                                
                                <!-- PC_pickup: „Éî„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Ç¢„Ç§„ÉÜ„É† -->
                                <div class="flex-1 overflow-y-auto px-5 space-y-3 pb-5">
                                    <div class="flex items-center gap-5 p-4 bg-white rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition">
                                        <div class="w-24 h-24 rounded-xl bg-gradient-to-br from-green-500 to-teal-500 flex items-center justify-center shrink-0 shadow-sm">
                                            <i class="fa-solid fa-list-check text-white text-2xl"></i>
                                        </div>
                                        <div class="font-medium text-gray-700 text-base" contenteditable="true">„Çø„Çπ„ÇØ</div>
                                    </div>
                                    <div class="flex items-center gap-5 p-4 bg-white rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition">
                                        <div class="w-24 h-24 rounded-xl bg-gradient-to-br from-red-500 to-pink-500 flex items-center justify-center shrink-0 shadow-sm">
                                            <i class="fa-solid fa-book text-white text-2xl"></i>
                                        </div>
                                        <div class="font-medium text-gray-700 text-base" contenteditable="true">ÂøÖË™≠„ÅÆÊäïÁ®ø</div>
                                    </div>
                                    <div class="flex items-center gap-5 p-4 bg-white rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition">
                                        <div class="w-24 h-24 rounded-xl bg-gradient-to-br from-orange-500 to-amber-500 flex items-center justify-center shrink-0 shadow-sm">
                                            <i class="fa-solid fa-envelope-open text-white text-2xl"></i>
                                        </div>
                                        <div class="font-medium text-gray-700 text-base" contenteditable="true">Êú™Ë™≠„ÅÆÊäïÁ®ø</div>
                                    </div>
                                    <div class="flex items-center gap-5 p-4 bg-white rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition">
                                        <div class="w-24 h-24 rounded-xl bg-gradient-to-br from-green-600 to-emerald-600 flex items-center justify-center shrink-0 shadow-sm">
                                            <i class="fa-solid fa-user-tie text-white text-2xl"></i>
                                        </div>
                                        <div class="font-medium text-gray-700 text-base" contenteditable="true">Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ -->
                            <div class="flex-1 overflow-y-auto min-w-0">
                                <!-- „É¶„Éº„Ç∂„ÉºÊÉÖÂ†± -->
                                <div class="bg-white flex items-center gap-4 px-8 pt-8 pb-4 border-b border-gray-100">
                                    <div class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center shrink-0">
                                        <i class="fa-solid fa-user text-red-500"></i>
                                    </div>
                                    <div class="flex flex-col">
                                        <div class="font-bold text-gray-700 text-xl" contenteditable="true">Èà¥Êú® ‰∏ÄÁßÄ</div>
                                        <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 9:21</div>
                                    </div>
                                </div>
                                
                                <!-- Ê≥®ÊÑè„É°„ÉÉ„Çª„Éº„Ç∏ -->
                                <div class="bg-white px-8 py-5 border-b border-gray-100">
                                    <div class="flex items-center gap-2">
                                        <span class="text-cyan-500 font-medium text-xl" contenteditable="true">Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏</span>
                                        <span class="text-gray-700 font-normal text-xl" contenteditable="true">„ÇíÂÖ¨Èñã„Åó„Åæ„Åó„ÅüÔºÅ</span>
                                    </div>
                                </div>
                                
                                <!-- „Çø„Ç§„Éà„É´ -->
                                <div class="bg-white px-8 py-5 border-b border-gray-100">
                                    <div class="text-gray-500 text-sm mb-2" contenteditable="true">„Çø„Ç§„Éà„É´</div>
                                    <div class="font-bold text-gray-800 text-2xl" contenteditable="true">"„Çâ„Åó„Åï"„ÇíÂ§ß‰∫ã„Å´„Åß„Åç„ÇãÁµÑÁπî„Å∏</div>
                                </div>
                                
                                <!-- „ÉÜ„Ç≠„Çπ„Éà„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
                                <div class="bg-white px-8 py-5 border-b border-gray-100">
                                    <div class="text-gray-500 text-sm mb-3" contenteditable="true">ÂÜÖÂÆπ</div>
                                    <div class="space-y-4 text-gray-700">
                                        <p class="text-base leading-relaxed" contenteditable="true">ÁöÜ„Åï„Çì„ÄÅ„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ</p>
                                        <p class="text-base leading-relaxed" contenteditable="true">Êú¨Êó•„ÅØ„ÄÅÁßÅ„ÅåÂ§ßÂàá„Å´„Åó„Å¶„ÅÑ„Çã„Äå„Çâ„Åó„ÅèÂÉç„Åè„Äç„Å®„ÅÑ„ÅÜ„ÉÜ„Éº„Éû„Å´„Å§„ÅÑ„Å¶„ÄÅ„ÅäË©±„Åó„Åï„Åõ„Å¶„ÅÑ„Åü„Å†„Åç„Åæ„Åô„ÄÇ</p>
                                        <p class="text-base leading-relaxed" contenteditable="true">ÁßÅ„Åü„Å°„ÅØ„ÄÅ‰∏Ä‰∫∫„Å≤„Å®„Çä„ÅåÊåÅ„Å§ÂÄãÊÄß„ÇÑÂº∑„Åø„ÇíÊ¥ª„Åã„Åó„Å™„Åå„Çâ„ÄÅ„ÉÅ„Éº„É†„Å®„Åó„Å¶ÊàêÊûú„ÇíÂá∫„Åó„Å¶„ÅÑ„Åè„Åì„Å®„ÅåÈáçË¶Å„Å†„Å®ËÄÉ„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
                                        <p class="text-base leading-relaxed" contenteditable="true">„Åù„Çå„Åû„Çå„ÅÆ„Äå„Çâ„Åó„Åï„Äç„ÇíÂ∞äÈáç„Åó„ÄÅ„Åä‰∫í„ÅÑ„ÇíÁêÜËß£„ÅóÂêà„ÅÜ„Åì„Å®„Åß„ÄÅ„Çà„ÇäËâØ„ÅÑËÅ∑Â†¥Áí∞Â¢É„ÅåÁîü„Åæ„Çå„Åæ„Åô„ÄÇ</p>
                                        <p class="text-base leading-relaxed" contenteditable="true">‰ªäÂπ¥„ÇÇ„ÄÅÁöÜ„Åï„Çì‰∏Ä‰∫∫„Å≤„Å®„Çä„Åå„Äå„Çâ„Åó„ÅèÂÉç„Åè„Äç„Åì„Å®„Åå„Åß„Åç„Çã„Çà„ÅÜ„ÄÅÂÖ®Âäõ„Åß„Çµ„Éù„Éº„Éà„Åó„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ‰∏ÄÁ∑í„Å´È†ëÂºµ„Çä„Åæ„Åó„Çá„ÅÜÔºÅ</p>
                                    </div>
                                    <div class="mt-4">
                                        <span class="text-cyan-500 text-sm cursor-pointer hover:underline" contenteditable="true">„ÇÇ„Å£„Å®Ë¶ã„Çã</span>
                                    </div>
                                </div>
                                
                                <!-- Èñ¢ÈÄ£„Åô„Çã„É°„É≥„Éê„Éº -->
                                <div class="bg-white px-8 py-5 border-b border-gray-100">
                                    <div class="text-gray-500 text-sm mb-4" contenteditable="true">Èñ¢ÈÄ£„Åô„Çã„É°„É≥„Éê„Éº</div>
                                    <div class="space-y-3">
                                        <!-- „É°„É≥„Éê„Éº„Ç´„Éº„Éâ1 -->
                                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition">
                                            <div class="flex items-center gap-5">
                                                <div class="w-16 h-16 rounded-full bg-yellow-100 flex items-center justify-center shrink-0">
                                                    <i class="fa-solid fa-user text-yellow-600 text-xl"></i>
                                                </div>
                                                <div class="flex flex-col">
                                                    <div class="font-bold text-gray-700 text-lg" contenteditable="true">Áî∞‰∏≠ ÂÑ™Âä©</div>
                                                    <div class="text-gray-500 text-sm" contenteditable="true">‰∫ãÊ•≠Ê≥ï‰∫∫ Á¨¨‰∏âÈÉ®</div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- „É°„É≥„Éê„Éº„Ç´„Éº„Éâ2 -->
                                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition">
                                            <div class="flex items-center gap-5">
                                                <div class="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center shrink-0">
                                                    <i class="fa-solid fa-user text-green-600 text-xl"></i>
                                                </div>
                                                <div class="flex flex-col">
                                                    <div class="font-bold text-gray-700 text-lg" contenteditable="true">ÂêâÂ∑ù ÁæéÁ¥óÂ≠ê</div>
                                                    <div class="text-gray-500 text-sm" contenteditable="true">„Ç§„É≥„Çµ„Ç§„Éâ„Çª„Éº„É´„ÇπÈÉ®</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ÂÜôÁúü -->
                                <div class="bg-white px-8 py-6 border-b border-gray-100">
                                    <div class="w-full h-96 bg-gray-200 rounded-xl flex items-center justify-center overflow-hidden">
                                        <div class="relative w-full h-full bg-gradient-to-br from-blue-100 to-purple-100">
                                            <div class="absolute inset-0 flex items-center justify-center">
                                                <div class="text-center">
                                                    <i class="fa-solid fa-users text-gray-400 text-6xl mb-4"></i>
                                                    <div class="text-gray-500 text-sm">ÁîªÂÉè„Éó„É¨„Éº„Çπ„Éõ„É´„ÉÄ„Éº</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- „Ç´„ÉÜ„Ç¥„É™ -->
                                <div class="bg-white px-8 py-5 border-b border-gray-100 flex items-center gap-6">
                                    <div class="w-20 h-20 rounded-2xl bg-yellow-400 flex items-center justify-center shrink-0">
                                        <i class="fa-solid fa-bullhorn text-white text-lg"></i>
                                    </div>
                                    <div class="flex flex-col">
                                        <div class="font-bold text-gray-700 text-lg mb-1" contenteditable="true">Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏</div>
                                        <div class="text-gray-600 text-base" contenteditable="true">Èà¥Êú®Á§æÈï∑„Åå‰∫ãÊ•≠„ÇÑ‰ºöÁ§æ„Å∏„ÅÆÊÄù„ÅÑ„Çí‰ºù„Åà„Åæ„Åôüî•</div>
                                    </div>
                                </div>
                                
                                <!-- „É™„Ç¢„ÇØ„Ç∑„Éß„É≥ -->
                                <div class="bg-white px-8 py-2 border-b border-gray-100 flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <!-- „É™„Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
                                        <div class="flex items-center gap-2">
                                            <div class="border-2 border-cyan-500 rounded-full px-3 py-2 flex items-center">
                                                <i class="fa-regular fa-heart text-cyan-500 text-sm"></i>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center">
                                                    <i class="fa-regular fa-face-smile text-gray-500 text-xs"></i>
                                                </div>
                                                <span class="text-gray-700 font-bold text-lg">1</span>
                                            </div>
                                            <div class="bg-gray-100 rounded-full px-3 py-2">
                                                <i class="fa-regular fa-comment text-gray-500 text-sm"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <!-- Êó¢Ë™≠„É¶„Éº„Ç∂„Éº -->
                                        <div class="flex -space-x-2">
                                            <div class="w-8 h-8 rounded-full bg-red-500 border-2 border-white"></div>
                                            <div class="w-8 h-8 rounded-full bg-pink-400 border-2 border-white"></div>
                                            <div class="w-8 h-8 rounded-full bg-green-500 border-2 border-white"></div>
                                            <div class="w-8 h-8 rounded-full bg-orange-400 border-2 border-white"></div>
                                            <div class="w-8 h-8 rounded-full bg-blue-400 border-2 border-white"></div>
                                        </div>
                                        <span class="text-cyan-500 text-sm" contenteditable="true">Êó¢Ë™≠ <span class="font-bold">31</span>‰∫∫</span>
                                    </div>
                                </div>
                                
                                <!-- „Ç≥„É°„É≥„Éà -->
                                <div class="bg-white">
                                    <!-- „Ç≥„É°„É≥„Éà1 -->
                                    <div class="px-8 py-6 border-b border-gray-100">
                                        <div class="flex items-start gap-4">
                                            <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center shrink-0">
                                                <i class="fa-solid fa-user text-green-600"></i>
                                            </div>
                                            <div class="flex-1">
                                                <div class="flex items-end gap-5 mb-1">
                                                    <div class="font-medium text-gray-700 text-base" contenteditable="true">ÂêâÂ∑ù ÁæéÁ¥óÂ≠ê</div>
                                                    <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 10:01</div>
                                                </div>
                                                <div class="text-gray-700 text-lg leading-relaxed" contenteditable="true">"„Çâ„Åó„ÅèÂÉç„Åè"„Å£„Å¶„ÄÅÊäΩË±°ÁöÑ„Å†„Åë„Å©Â••Ê∑±„ÅÑË®ÄËëâ„Åß„Åô„Å≠„ÄÇ<br>„ÉÅ„Éº„É†„Å®„Åó„Å¶„Å©„ÅÜÂú®„Çå„Çã„Åã„ÄÅËÄÉ„Åà„Å¶„Åø„Åü„Åè„Å™„Çä„Åæ„Åó„ÅüÔºÅ</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- „Ç≥„É°„É≥„Éà2 -->
                                    <div class="px-8 py-6 border-b border-gray-100">
                                        <div class="flex items-start gap-4">
                                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center shrink-0">
                                                <i class="fa-solid fa-user text-blue-600"></i>
                                            </div>
                                            <div class="flex-1">
                                                <div class="flex items-end gap-5 mb-1">
                                                    <div class="font-medium text-gray-700 text-base" contenteditable="true">Â±±Áî∞ Â§™ÈÉé</div>
                                                    <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 10:15</div>
                                                </div>
                                                <div class="text-gray-700 text-lg leading-relaxed" contenteditable="true">Á§æÈï∑„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏„ÄÅ„Å®„Å¶„ÇÇÂÖ±ÊÑü„Åó„Åæ„Åó„Åü„ÄÇËá™ÂàÜ„Çâ„Åó„Åï„ÇíÂ§ßÂàá„Å´„Åó„Å™„Åå„Çâ„ÄÅ„ÉÅ„Éº„É†„ÅÆ‰∏ÄÂì°„Å®„Åó„Å¶Ë≤¢ÁåÆ„Åó„Å¶„ÅÑ„Åç„Åü„ÅÑ„Åß„Åô„ÄÇ</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- „Ç≥„É°„É≥„Éà3 -->
                                    <div class="px-8 py-6">
                                        <div class="flex items-start gap-4">
                                            <div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center shrink-0">
                                                <i class="fa-solid fa-user text-purple-600"></i>
                                            </div>
                                            <div class="flex-1">
                                                <div class="flex items-end gap-5 mb-1">
                                                    <div class="font-medium text-gray-700 text-base" contenteditable="true">‰ΩêËó§ Ëä±Â≠ê</div>
                                                    <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 10:30</div>
                                                </div>
                                                <div class="text-gray-700 text-lg leading-relaxed" contenteditable="true">‰ªäÂπ¥„ÇÇ„Çà„Çç„Åó„Åè„ÅäÈ°ò„ÅÑ„Åó„Åæ„ÅôÔºÅ‰∏Ä‰∫∫„Å≤„Å®„Çä„ÅÆÂÄãÊÄß„ÇíÊ¥ª„Åã„Åõ„ÇãËÅ∑Â†¥Áí∞Â¢É„Çí„ÄÅ„Åø„Çì„Å™„Åß‰Ωú„Å£„Å¶„ÅÑ„Åç„Åæ„Åó„Çá„ÅÜ„ÄÇ</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Âè≥„Çµ„Ç§„Éâ„Éê„Éº -->
                            <div class="w-96 bg-white border-l border-gray-200 flex flex-col shrink-0">
                                <!-- PC_mustread: ÂøÖË™≠ÊäïÁ®ø -->
                                <div class="m-5 mb-4 bg-white rounded-lg overflow-hidden shadow-sm">
                                    <div class="bg-white px-5 py-4 flex items-center justify-between border-b border-gray-200">
                                        <div class="font-bold text-gray-700 text-lg" contenteditable="true">ÂøÖË™≠ÊäïÁ®ø</div>
                                        <div class="flex items-center gap-1 text-gray-600 text-sm cursor-pointer hover:text-gray-800">
                                            <span contenteditable="true">„Åô„Åπ„Å¶Ë¶ã„Çã</span>
                                            <i class="fa-solid fa-chevron-right text-xs"></i>
                                        </div>
                                    </div>
                                    <div class="h-80 bg-orange-400 relative overflow-hidden">
                                        <div class="absolute inset-0 bg-gradient-to-br from-orange-400 to-orange-600">
                                            <!-- Âêπ„ÅçÂá∫„Åó„Ç¢„Ç§„Ç≥„É≥ -->
                                            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
                                                <div class="bg-white rounded-full w-32 h-32 flex items-center justify-center shadow-lg">
                                                    <i class="fa-solid fa-heart text-red-500 text-4xl"></i>
                                                </div>
                                            </div>
                                            <!-- Â∞è„Åï„Å™„É¶„Éº„Ç∂„Éº„Ç¢„Ç§„Ç≥„É≥ -->
                                            <div class="absolute bottom-20 left-1/2 transform -translate-x-1/2 flex gap-2">
                                                <div class="w-8 h-8 rounded-full bg-white border-2 border-white shadow"></div>
                                                <div class="w-8 h-8 rounded-full bg-white border-2 border-white shadow"></div>
                                            </div>
                                        </div>
                                        <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 px-5 py-4">
                                            <div class="text-white font-bold text-center text-lg" contenteditable="true">‰ªäÈÄ±„ÅÆ„Éô„Çπ„ÉàÊäïÁ®ø</div>
                                        </div>
                                    </div>
                                    <div class="bg-white px-5 py-4 flex items-center justify-between">
                                        <div class="flex items-center gap-3">
                                            <span class="bg-red-500 text-white text-xs px-3 py-1.5 rounded font-medium" contenteditable="true">UPDATE</span>
                                            <span class="text-gray-600 text-sm" contenteditable="true">4Êúà28Êó•</span>
                                        </div>
                                        <div class="text-cyan-600 font-bold text-sm cursor-pointer hover:text-cyan-700" contenteditable="true">Á¢∫Ë™ç„Åô„Çã <i class="fa-solid fa-chevron-right text-xs"></i></div>
                                    </div>
                                    <div class="flex justify-center gap-2 pb-4">
                                        <div class="w-2.5 h-2.5 rounded-full bg-cyan-500"></div>
                                        <div class="w-2.5 h-2.5 rounded-full bg-gray-300"></div>
                                        <div class="w-2.5 h-2.5 rounded-full bg-gray-300"></div>
                                    </div>
                                </div>
                                
                                <!-- PC_menu: „É°„Éã„É•„Éº -->
                                <div class="mx-5 mb-4 bg-white rounded-lg p-5 shadow-sm border border-gray-100">
                                    <div class="flex items-center gap-4">
                                        <div class="w-14 h-14 rounded bg-blue-500 flex items-center justify-center shrink-0 shadow-sm">
                                            <i class="fa-solid fa-envelope text-white text-xl"></i>
                                        </div>
                                        <div class="font-medium text-gray-700 text-base" contenteditable="true">„É°„Éº„É´</div>
                                    </div>
                                </div>
                                
                                <!-- PC_notice: „ÅäÁü•„Çâ„Åõ -->
                                <div class="flex-1 overflow-y-auto px-5 space-y-3 pb-5">
                                    <div class="text-gray-500 text-sm font-medium mb-2" contenteditable="true">„ÅäÁü•„Çâ„Åõ</div>
                                    <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover:shadow-md transition">
                                        <div class="text-sm text-gray-700 mb-1" contenteditable="true">Ê¶éÊú¨ ÊÇ†Áúü„Åï„Çì„Åå„ÅÇ„Å™„ÅüÂÆõ„Å´„Ç≥„É°„É≥„Éà„Åó„Åæ„Åó„Åü„ÄÇ</div>
                                        <div class="text-xs text-gray-500" contenteditable="true">23ÂàÜÂâç</div>
                                    </div>
                                    <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover:shadow-md transition">
                                        <div class="text-sm text-gray-700 mb-1" contenteditable="true">È´òÊ©ã ÁæéÂí≤„Åï„Çì„Åå„ÅÇ„Å™„ÅüÂÆõ„Å´„Ç≥„É°„É≥„Éà„Åó„Åæ„Åó„Åü„ÄÇ</div>
                                        <div class="text-xs text-gray-500" contenteditable="true">12Êúà9Êó• 11:14</div>
                                    </div>
                                    <div class="pt-2">
                                        <div class="text-cyan-600 text-sm cursor-pointer hover:text-cyan-700 font-medium" contenteditable="true">„ÇÇ„Å£„Å®„Åø„Çã <i class="fa-solid fa-chevron-right text-xs"></i></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
            }
            if (els.contentHtml) {
            els.contentHtml.innerHTML = html;
            }
        }

        // --- 2. Customize (Builder) Logic (Generic Templates) ---
        function applyBuilder(type) {
            state.lastBuilder = type;
            let html = '';
            
            // Update UI
            document.querySelectorAll('#content-builder .btn-select').forEach(btn => {
                if(btn.getAttribute('onclick').includes(type)) btn.classList.add('active');
                else btn.classList.remove('active');
            });

            if (type === 'timeline') {
                html = `
                    <div class="${baseClass}">
                        <!-- PC_header: ÂÖ±ÈÄö„Éò„ÉÉ„ÉÄ„Éº„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà -->
                        ${createPCHeader()}
                        <div class="flex-1 overflow-y-auto bg-gray-50">
                            <!-- „É¶„Éº„Ç∂„ÉºÊÉÖÂ†± -->
                            <div class="bg-white flex items-center gap-3 px-6 pt-6 pb-2.5">
                                <div class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center shrink-0">
                                    <i class="fa-solid fa-user text-red-500 text-xs"></i>
                        </div>
                                <div class="flex flex-col">
                                    <div class="font-bold text-gray-700 text-lg" contenteditable="true">Èà¥Êú® ‰∏ÄÁßÄ</div>
                                    <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 9:21</div>
                                    </div>
                                </div>
                            
                            <!-- Ê≥®ÊÑè„É°„ÉÉ„Çª„Éº„Ç∏ -->
                            <div class="bg-white px-6 py-4 border-b border-gray-100">
                                <div class="flex items-center gap-2">
                                    <span class="text-cyan-500 font-medium text-lg" contenteditable="true">Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏</span>
                                    <span class="text-gray-700 font-normal text-lg" contenteditable="true">„ÇíÂÖ¨Èñã„Åó„Åæ„Åó„ÅüÔºÅ</span>
                                </div>
                            </div>
                            
                            <!-- „ÉÜ„Ç≠„Çπ„Éà„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
                            <div class="bg-white px-6 py-4 border-b border-gray-100">
                                <div class="space-y-3 text-gray-700">
                                    <p class="text-base leading-relaxed" contenteditable="true">ÁöÜ„Åï„Çì„ÄÅ„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ</p>
                                    <p class="text-base leading-relaxed" contenteditable="true">Êú¨Êó•„ÅØ„ÄÅÁßÅ„ÅåÂ§ßÂàá„Å´„Åó„Å¶„ÅÑ„Çã„Äå„Çâ„Åó„ÅèÂÉç„Åè„Äç„Å®„ÅÑ„ÅÜ„ÉÜ„Éº„Éû„Å´„Å§„ÅÑ„Å¶„ÄÅ„ÅäË©±„Åó„Åï„Åõ„Å¶„ÅÑ„Åü„Å†„Åç„Åæ„Åô„ÄÇ</p>
                                    <p class="text-base leading-relaxed" contenteditable="true">ÁßÅ„Åü„Å°„ÅØ„ÄÅ‰∏Ä‰∫∫„Å≤„Å®„Çä„ÅåÊåÅ„Å§ÂÄãÊÄß„ÇÑÂº∑„Åø„ÇíÊ¥ª„Åã„Åó„Å™„Åå„Çâ„ÄÅ„ÉÅ„Éº„É†„Å®„Åó„Å¶ÊàêÊûú„ÇíÂá∫„Åó„Å¶„ÅÑ„Åè„Åì„Å®„ÅåÈáçË¶Å„Å†„Å®ËÄÉ„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
                                    <p class="text-base leading-relaxed" contenteditable="true">„Åù„Çå„Åû„Çå„ÅÆ„Äå„Çâ„Åó„Åï„Äç„ÇíÂ∞äÈáç„Åó„ÄÅ„Åä‰∫í„ÅÑ„ÇíÁêÜËß£„ÅóÂêà„ÅÜ„Åì„Å®„Åß„ÄÅ„Çà„ÇäËâØ„ÅÑËÅ∑Â†¥Áí∞Â¢É„ÅåÁîü„Åæ„Çå„Åæ„Åô„ÄÇ</p>
                                    <p class="text-base leading-relaxed mt-4" contenteditable="true">‰ªäÂπ¥„ÇÇ„ÄÅÁöÜ„Åï„Çì‰∏Ä‰∫∫„Å≤„Å®„Çä„Åå„Äå„Çâ„Åó„ÅèÂÉç„Åè„Äç„Åì„Å®„Åå„Åß„Åç„Çã„Çà„ÅÜ„ÄÅÂÖ®Âäõ„Åß„Çµ„Éù„Éº„Éà„Åó„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ‰∏ÄÁ∑í„Å´È†ëÂºµ„Çä„Åæ„Åó„Çá„ÅÜÔºÅ</p>
                                </div>
                            </div>
                            
                            <!-- „É°„É≥„Éê„ÉºÊÉÖÂ†± -->
                            <div class="bg-white px-6 py-4 border-b border-gray-100">
                                <div class="space-y-4">
                                    <!-- „É°„É≥„Éê„Éº„Ç´„Éº„Éâ1 -->
                                    <div class="border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center gap-6">
                                            <div class="w-18 h-18 rounded-full bg-yellow-100 flex items-center justify-center shrink-0">
                                                <i class="fa-solid fa-user text-yellow-600"></i>
                                            </div>
                                            <div class="flex flex-col">
                                                <div class="font-bold text-gray-700 text-lg" contenteditable="true">Áî∞‰∏≠ ÂÑ™Âä©</div>
                                                <div class="text-gray-500 text-sm" contenteditable="true">‰∫ãÊ•≠Ê≥ï‰∫∫ Á¨¨‰∏âÈÉ®</div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- „É°„É≥„Éê„Éº„Ç´„Éº„Éâ2 -->
                                    <div class="border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center gap-6">
                                            <div class="w-18 h-18 rounded-full bg-green-100 flex items-center justify-center shrink-0">
                                                <i class="fa-solid fa-user text-green-600"></i>
                                            </div>
                                            <div class="flex flex-col">
                                                <div class="font-bold text-gray-700 text-lg" contenteditable="true">ÂêâÂ∑ù ÁæéÁ¥óÂ≠ê</div>
                                                <div class="text-gray-500 text-sm" contenteditable="true">„Ç§„É≥„Çµ„Ç§„Éâ„Çª„Éº„É´„ÇπÈÉ®</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ÂÜôÁúü -->
                            <div class="bg-white px-6 py-6 border-b border-gray-100">
                                <div class="w-full h-96 bg-gray-200 rounded-xl flex items-center justify-center">
                                    <i class="fa-solid fa-image text-gray-400 text-4xl"></i>
                                </div>
                            </div>
                            
                            <!-- „Ç´„ÉÜ„Ç¥„É™ -->
                            <div class="bg-white px-6 py-5 border-b border-gray-100 flex items-center gap-6">
                                <div class="w-23 h-23 rounded-2xl bg-yellow-400 flex items-center justify-center shrink-0">
                                    <i class="fa-solid fa-bullhorn text-white text-sm"></i>
                                </div>
                                <div class="flex flex-col">
                                    <div class="font-bold text-gray-700 text-lg mb-1" contenteditable="true">Á§æÈï∑„É°„ÉÉ„Çª„Éº„Ç∏</div>
                                    <div class="text-gray-600 text-base" contenteditable="true">Èà¥Êú®Á§æÈï∑„Åå‰∫ãÊ•≠„ÇÑ‰ºöÁ§æ„Å∏„ÅÆÊÄù„ÅÑ„Çí‰ºù„Åà„Åæ„Åôüî•</div>
                                </div>
                            </div>
                            
                            <!-- „É™„Ç¢„ÇØ„Ç∑„Éß„É≥ -->
                            <div class="bg-white px-6 py-1 border-b border-gray-100 flex items-center justify-between">
                                <div class="flex items-center gap-4">
                                    <!-- „É™„Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
                                    <div class="flex items-center gap-2">
                                        <div class="border-2 border-cyan-500 rounded-full px-3 py-2 flex items-center">
                                            <i class="fa-regular fa-heart text-cyan-500 text-sm"></i>
                                        </div>
                                        <div class="flex items-center gap-2">
                                            <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center">
                                                <i class="fa-regular fa-face-smile text-gray-500 text-xs"></i>
                                            </div>
                                            <span class="text-gray-700 font-bold text-lg">1</span>
                                        </div>
                                        <div class="bg-gray-100 rounded-full px-3 py-2">
                                            <i class="fa-regular fa-comment text-gray-500 text-sm"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2">
                                    <!-- Êó¢Ë™≠„É¶„Éº„Ç∂„Éº -->
                                    <div class="flex -space-x-2">
                                        <div class="w-8 h-8 rounded-full bg-red-500 border-2 border-white"></div>
                                        <div class="w-8 h-8 rounded-full bg-pink-400 border-2 border-white"></div>
                                        <div class="w-8 h-8 rounded-full bg-green-500 border-2 border-white"></div>
                                        <div class="w-8 h-8 rounded-full bg-orange-400 border-2 border-white"></div>
                                        <div class="w-8 h-8 rounded-full bg-blue-400 border-2 border-white"></div>
                                    </div>
                                    <span class="text-cyan-500 text-sm" contenteditable="true">Êó¢Ë™≠ <span class="font-bold">31</span>‰∫∫</span>
                                </div>
                            </div>
                            
                            <!-- „Ç≥„É°„É≥„Éà -->
                            <div class="bg-white">
                                <!-- „Ç≥„É°„É≥„Éà1 -->
                                <div class="px-6 py-6 border-b border-gray-100">
                                    <div class="flex items-start gap-4">
                                        <div class="w-4 h-4 rounded-full bg-green-100 flex items-center justify-center shrink-0 mt-1">
                                            <i class="fa-solid fa-user text-green-600 text-xs"></i>
                                        </div>
                                        <div class="flex-1">
                                            <div class="flex items-end gap-5 mb-1">
                                                <div class="font-medium text-gray-700 text-base" contenteditable="true">ÂêâÂ∑ù ÁæéÁ¥óÂ≠ê</div>
                                                <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 10:01</div>
                                            </div>
                                            <div class="text-gray-700 text-lg leading-relaxed" contenteditable="true">"„Çâ„Åó„ÅèÂÉç„Åè"„Å£„Å¶„ÄÅÊäΩË±°ÁöÑ„Å†„Åë„Å©Â••Ê∑±„ÅÑË®ÄËëâ„Åß„Åô„Å≠„ÄÇ<br>„ÉÅ„Éº„É†„Å®„Åó„Å¶„Å©„ÅÜÂú®„Çå„Çã„Åã„ÄÅËÄÉ„Åà„Å¶„Åø„Åü„Åè„Å™„Çä„Åæ„Åó„ÅüÔºÅ</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- „Ç≥„É°„É≥„Éà2 -->
                                <div class="px-6 py-6 border-b border-gray-100">
                                    <div class="flex items-start gap-4">
                                        <div class="w-4 h-4 rounded-full bg-blue-100 flex items-center justify-center shrink-0 mt-1">
                                            <i class="fa-solid fa-user text-blue-600 text-xs"></i>
                                        </div>
                                        <div class="flex-1">
                                            <div class="flex items-end gap-5 mb-1">
                                                <div class="font-medium text-gray-700 text-base" contenteditable="true">Â±±Áî∞ Â§™ÈÉé</div>
                                                <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 10:15</div>
                                            </div>
                                            <div class="text-gray-700 text-lg leading-relaxed" contenteditable="true">Á§æÈï∑„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏„ÄÅ„Å®„Å¶„ÇÇÂÖ±ÊÑü„Åó„Åæ„Åó„Åü„ÄÇËá™ÂàÜ„Çâ„Åó„Åï„ÇíÂ§ßÂàá„Å´„Åó„Å™„Åå„Çâ„ÄÅ„ÉÅ„Éº„É†„ÅÆ‰∏ÄÂì°„Å®„Åó„Å¶Ë≤¢ÁåÆ„Åó„Å¶„ÅÑ„Åç„Åü„ÅÑ„Åß„Åô„ÄÇ</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- „Ç≥„É°„É≥„Éà3 -->
                                <div class="px-6 py-6">
                                    <div class="flex items-start gap-4">
                                        <div class="w-4 h-4 rounded-full bg-purple-100 flex items-center justify-center shrink-0 mt-1">
                                            <i class="fa-solid fa-user text-purple-600 text-xs"></i>
                                        </div>
                                        <div class="flex-1">
                                            <div class="flex items-end gap-5 mb-1">
                                                <div class="font-medium text-gray-700 text-base" contenteditable="true">‰ΩêËó§ Ëä±Â≠ê</div>
                                                <div class="text-gray-400 text-sm" contenteditable="true">1Êúà13Êó• 10:30</div>
                                            </div>
                                            <div class="text-gray-700 text-lg leading-relaxed" contenteditable="true">‰ªäÂπ¥„ÇÇ„Çà„Çç„Åó„Åè„ÅäÈ°ò„ÅÑ„Åó„Åæ„ÅôÔºÅ‰∏Ä‰∫∫„Å≤„Å®„Çä„ÅÆÂÄãÊÄß„ÇíÊ¥ª„Åã„Åõ„ÇãËÅ∑Â†¥Áí∞Â¢É„Çí„ÄÅ„Åø„Çì„Å™„Åß‰Ωú„Å£„Å¶„ÅÑ„Åç„Åæ„Åó„Çá„ÅÜ„ÄÇ</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
            } else if (type === 'chat') {
                html = `
                    <div class="${baseClass}">
                        <div class="h-14 bg-white border-b flex items-center px-4 gap-2 shrink-0">
                            <i class="fa-solid fa-chevron-left text-gray-400"></i>
                            <div class="font-bold text-gray-800" contenteditable="true">„Éà„Éº„ÇØ„É´„Éº„É†Âêç</div>
                        </div>
                        <div class="flex-1 p-4 space-y-4 overflow-y-auto bg-gray-50">
                            <div class="flex gap-2">
                                <div class="w-8 h-8 rounded-full bg-gray-200"></div>
                                <div class="bg-white p-3 rounded-r-lg rounded-bl-lg shadow-sm border text-sm max-w-[80%]" contenteditable="true">Áõ∏Êâã„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏</div>
                            </div>
                            <div class="flex gap-2 flex-row-reverse">
                                <div class="bg-tunag-blue text-white p-3 rounded-l-lg rounded-br-lg shadow-sm text-sm max-w-[80%]" contenteditable="true">Ëá™ÂàÜ„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏</div>
                            </div>
                        </div>
                         <div class="h-14 bg-white border-t px-3 flex items-center gap-2 shrink-0">
                            <div class="flex-1 h-9 bg-gray-100 rounded px-2 flex items-center text-sm text-gray-400">ÂÖ•Âäõ„Ç®„É™„Ç¢...</div>
                        </div>
                    </div>`;
            } else if (type === 'portal') {
                html = `
                    <div class="${baseClass}">
                        <div class="bg-white p-4 border-b flex justify-between items-center shrink-0">
                            <div class="font-bold" contenteditable="true">„Éù„Éº„Çø„É´</div>
                            <i class="fa-solid fa-bars"></i>
                        </div>
                        <div class="flex-1 p-4 overflow-y-auto">
                            <div class="bg-white p-4 rounded shadow-sm border mb-4" contenteditable="true">
                                <h3 class="font-bold mb-2">„Éà„ÉÉ„Éó„Éã„É•„Éº„Çπ</h3>
                                <p class="text-sm text-gray-600">„Åì„Åì„Å´ÈáçË¶Å„Å™ÊÉÖÂ†±„ÇíÈÖçÁΩÆ„Åó„Åæ„Åô„ÄÇ</p>
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                <div class="bg-white p-4 rounded shadow-sm border h-24 flex items-center justify-center text-sm font-bold" contenteditable="true">„É°„Éã„É•„ÉºA</div>
                                <div class="bg-white p-4 rounded shadow-sm border h-24 flex items-center justify-center text-sm font-bold" contenteditable="true">„É°„Éã„É•„ÉºB</div>
                                <div class="bg-white p-4 rounded shadow-sm border h-24 flex items-center justify-center text-sm font-bold" contenteditable="true">„É°„Éã„É•„ÉºC</div>
                                <div class="bg-white p-4 rounded shadow-sm border h-24 flex items-center justify-center text-sm font-bold" contenteditable="true">„É°„Éã„É•„ÉºD</div>
                            </div>
                        </div>
                    </div>`;
            } else if (type === 'other') {
                html = `
                    <div class="${baseClass}">
                        <div class="h-14 bg-white border-b flex items-center px-4 justify-between shrink-0">
                            <div class="font-bold" contenteditable="true">„Éö„Éº„Ç∏„Çø„Ç§„Éà„É´</div>
                            <i class="fa-solid fa-xmark text-gray-400"></i>
                        </div>
                        <div class="flex-1 p-5 overflow-y-auto flex flex-col items-center justify-center text-gray-400 border-2 border-dashed border-gray-200 m-4 rounded">
                            <i class="fa-solid fa-pen-ruler text-3xl mb-2"></i>
                            <div contenteditable="true">Ëá™Áî±Á∑®ÈõÜ„Ç®„É™„Ç¢</div>
                        </div>
                    </div>`;
            }
            if (els.contentHtml) {
            els.contentHtml.innerHTML = html;
            }
        }

        // --- Download ---
        function downloadImage() {
            if (!els.wrapper) {
                alert('„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åô„Çã„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                return;
            }
            
            const target = els.wrapper;
            const originalShadow = target.style.boxShadow;
            const originalBg = target.style.backgroundColor;
            const originalOverflow = target.style.overflow;
            
            // Ë¶ÅÁ¥†„ÅÆ„Çµ„Ç§„Ç∫„ÇíÁ¢∫Ë™çÔºà„Çπ„Çø„Ç§„É´Â§âÊõ¥ÂâçÔºâ
            const width = target.offsetWidth || target.clientWidth;
            const height = target.offsetHeight || target.clientHeight;
            
            if (width === 0 || height === 0) {
                alert('Ë¶ÅÁ¥†„ÅÆ„Çµ„Ç§„Ç∫„Åå0„Åß„Åô„ÄÇ„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                return;
            }
            
            // ‰∏ÄÊôÇÁöÑ„Å´„Çπ„Çø„Ç§„É´„ÇíË™øÊï¥Ôºà„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®Ôºâ
            const originalWidth = target.style.width;
            const originalHeight = target.style.height;
            target.style.boxShadow = 'none'; 
            target.style.backgroundColor = 'transparent';
            target.style.overflow = 'visible';
            // „Çµ„Ç§„Ç∫„ÇíÊòéÁ§∫ÁöÑ„Å´Âõ∫ÂÆöÔºà„Ç¢„Çπ„Éö„ÇØ„ÉàÊØî„ÇíÁ∂≠ÊåÅÔºâ
            target.style.width = `${width}px`;
            target.style.height = `${height}px`;
            
            // „Åô„Åπ„Å¶„ÅÆÁîªÂÉè„ÅåË™≠„ÅøËæº„Åæ„Çå„Çã„Åæ„ÅßÂæÖ„Å§
            const waitForImages = (element) => {
                return new Promise((resolve) => {
                    const images = element.querySelectorAll('img');
                    let loadedCount = 0;
                    const totalImages = images.length;
                    
                    if (totalImages === 0) {
                        resolve();
                        return;
                    }
                    
                    images.forEach((img) => {
                        if (img.complete && img.naturalHeight !== 0) {
                            loadedCount++;
                            if (loadedCount === totalImages) resolve();
                        } else {
                            const checkLoad = () => {
                                loadedCount++;
                                if (loadedCount === totalImages) resolve();
                            };
                            img.onload = checkLoad;
                            img.onerror = checkLoad;
                        }
                    });
                });
            };
            
            // ÁîªÂÉè„ÅÆË™≠„ÅøËæº„Åø„ÇíÂæÖ„Å£„Å¶„Åã„Çâhtml2canvas„ÇíÂÆüË°å
            waitForImages(target).then(() => {
                setTimeout(() => {
                    // ÂÜçÂ∫¶„Çµ„Ç§„Ç∫„ÇíÂèñÂæóÔºàÁîªÂÉèË™≠„ÅøËæº„ÅøÂæå„ÅÆÊ≠£Á¢∫„Å™„Çµ„Ç§„Ç∫Ôºâ
                    const finalWidth = target.offsetWidth || target.clientWidth;
                    const finalHeight = target.offsetHeight || target.clientHeight;
                    
                    if (finalWidth === 0 || finalHeight === 0) {
                        alert('Ë¶ÅÁ¥†„ÅÆ„Çµ„Ç§„Ç∫„Åå0„Åß„Åô„ÄÇ„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                        target.style.boxShadow = originalShadow;
                        target.style.backgroundColor = originalBg;
                        target.style.overflow = originalOverflow;
                        target.style.width = originalWidth;
                        target.style.height = originalHeight;
                        // screen-area„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÜçË®àÁÆó
                        updateScreenArea();
                        return;
                    }
                    
            document.fonts.ready.then(() => {
                        // Ë¶ÅÁ¥†„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÜçÂ∫¶Á¢∫Ë™ç„Åó„Å¶ÊòéÁ§∫ÁöÑ„Å´Ë®≠ÂÆö
                        target.style.width = `${finalWidth}px`;
                        target.style.height = `${finalHeight}px`;
                        
                        // Â∞ë„ÅóÂæÖ„Å£„Å¶„Åã„Çâhtml2canvas„ÇíÂÆüË°åÔºà„É¨„Ç§„Ç¢„Ç¶„Éà„ÅåÁ¢∫ÂÆö„Åô„Çã„Åæ„ÅßÔºâ
                        setTimeout(() => {
                            // html2canvas„Å´„Çµ„Ç§„Ç∫„ÇíÊòéÁ§∫ÁöÑ„Å´ÊåáÂÆö
                            html2canvas(target, { 
                                backgroundColor: null, // ÈÄèÊòéËÉåÊôØ
                                scale: 2, 
                                logging: false, 
                                useCORS: false, // file://„Éó„É≠„Éà„Ç≥„É´„Åß„ÅØ‰ΩøÁî®‰∏çÂèØ
                                allowTaint: true, // tainted canvas„ÇíË®±ÂèØÔºàfile://„Éó„É≠„Éà„Ç≥„É´„Åß„ÅØÂøÖË¶ÅÔºâ
                                removeContainer: false,
                                imageTimeout: 15000,
                                foreignObjectRendering: false, // foreignObject„ÇíÁÑ°ÂäπÂåñ
                                windowWidth: finalWidth,
                                windowHeight: finalHeight
                            }).then(canvas => {
                            // „Ç≠„É£„É≥„Éê„Çπ„ÅåÁ©∫„Åß„Å™„ÅÑ„ÅãÁ¢∫Ë™ç
                            if (canvas.width === 0 || canvas.height === 0) {
                                throw new Error('„Ç≠„É£„É≥„Éê„Çπ„ÅÆ„Çµ„Ç§„Ç∫„Åå0„Åß„Åô');
                            }
                            
                            // „Ç≠„É£„É≥„Éê„Çπ„ÅÆ„Çµ„Ç§„Ç∫„ÅåË¶ÅÁ¥†„ÅÆ„Çµ„Ç§„Ç∫„Å®Â§ß„Åç„ÅèÁï∞„Å™„ÇãÂ†¥Âêà„ÅØË™øÊï¥
                            const expectedWidth = finalWidth * 2; // scale: 2
                            const expectedHeight = finalHeight * 2;
                            const widthDiff = Math.abs(canvas.width - expectedWidth) / expectedWidth;
                            const heightDiff = Math.abs(canvas.height - expectedHeight) / expectedHeight;
                            
                            // „Çµ„Ç§„Ç∫„ÅÆÂ∑Æ„Åå10%‰ª•‰∏ä„ÅÇ„ÇãÂ†¥Âêà„ÅØ„Ç≠„É£„É≥„Éê„Çπ„Çí„É™„Çµ„Ç§„Ç∫
                            let finalCanvas = canvas;
                            if (widthDiff > 0.1 || heightDiff > 0.1) {
                                console.warn('„Ç≠„É£„É≥„Éê„Çπ„Çµ„Ç§„Ç∫„ÅåÊúüÂæÖÂÄ§„Å®Áï∞„Å™„Çä„Åæ„Åô„ÄÇ„É™„Çµ„Ç§„Ç∫„Åó„Åæ„Åô:', {
                                    expected: { width: expectedWidth, height: expectedHeight },
                                    actual: { width: canvas.width, height: canvas.height }
                                });
                                
                                // Êñ∞„Åó„ÅÑ„Ç≠„É£„É≥„Éê„Çπ„Çí‰ΩúÊàê„Åó„Å¶„É™„Çµ„Ç§„Ç∫
                                const resizedCanvas = document.createElement('canvas');
                                resizedCanvas.width = expectedWidth;
                                resizedCanvas.height = expectedHeight;
                                const ctx = resizedCanvas.getContext('2d');
                                
                                // ÂÖÉ„ÅÆ„Ç≠„É£„É≥„Éê„Çπ„Çí„É™„Çµ„Ç§„Ç∫„Åó„Å¶ÊèèÁîª
                                ctx.drawImage(canvas, 0, 0, expectedWidth, expectedHeight);
                                finalCanvas = resizedCanvas;
                            }
                            
                            // „Çπ„Çø„Ç§„É´„ÇíÂÖÉ„Å´Êàª„Åô
                    target.style.boxShadow = originalShadow;
                            target.style.backgroundColor = originalBg;
                            target.style.overflow = originalOverflow;
                            target.style.width = originalWidth;
                            target.style.height = originalHeight;
                            
                            // screen-area„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÜçË®àÁÆó
                            updateScreenArea();
                            
                            // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÔºàtainted canvas„Åß„ÇÇtoDataURL„ÅØÂãï‰Ωú„Åô„ÇãÔºâ
                            try {
                    const link = document.createElement('a');
                    link.download = `tunag-mockup-${Date.now()}.png`;
                                link.href = finalCanvas.toDataURL('image/png', 1.0);
                                document.body.appendChild(link);
                    link.click();
                                document.body.removeChild(link);
                            } catch (e) {
                                // toDataURL„ÅåÂ§±Êïó„Åó„ÅüÂ†¥Âêà„ÄÅblob URL„Çí‰ΩøÁî®
                                console.warn('toDataURL„Å´Â§±Êïó„ÄÅblob URL„ÇíË©¶Ë°å:', e);
                                finalCanvas.toBlob((blob) => {
                                    if (blob) {
                                        const url = URL.createObjectURL(blob);
                                        const link = document.createElement('a');
                                        link.download = `tunag-mockup-${Date.now()}.png`;
                                        link.href = url;
                                        document.body.appendChild(link);
                                        link.click();
                                        document.body.removeChild(link);
                                        URL.revokeObjectURL(url);
                                    } else {
                                        throw new Error('Blob„ÅÆ‰ΩúÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                                    }
                                }, 'image/png');
                            }
                            }).catch(err => {
                            console.error('ÁîªÂÉè„ÅÆÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:', err);
                            alert('ÁîªÂÉè„ÅÆÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ\n\n„Ç®„É©„Éº: ' + (err.message || '‰∏çÊòé„Å™„Ç®„É©„Éº') + '\n\n„É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´Ôºàfile://Ôºâ„Åß„ÅØÂà∂Èôê„Åå„ÅÇ„ÇãÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ\nWeb„Çµ„Éº„Éê„ÉºÁµåÁî±„Åß„Ç¢„ÇØ„Çª„Çπ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                            // „Çπ„Çø„Ç§„É´„ÇíÂÖÉ„Å´Êàª„Åô
                            target.style.boxShadow = originalShadow;
                            target.style.backgroundColor = originalBg;
                            target.style.overflow = originalOverflow;
                            target.style.width = originalWidth;
                            target.style.height = originalHeight;
                            
                            // screen-area„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÜçË®àÁÆó
                            updateScreenArea();
                        });
                        }, 50); // „É¨„Ç§„Ç¢„Ç¶„Éà„ÅåÁ¢∫ÂÆö„Åô„Çã„Åæ„ÅßÂ∞ë„ÅóÂæÖ„Å§
                    });
                }, 300);
            });
        }
    </script>
</body>
</html>